Array.prototype.toAscStr=function(){for(var b=[],a=0;a<this.length;a++)b[a]=String.fromCharCode(this[a]);return b.join("")};Array.prototype.toHexStr=function(){for(var b=[],a=0;a<this.length;a++)b[a]=this[a].toHexStr();return b.join("")};Array.prototype.xorArray=function(c){if(this.length!=c.length)return new Error("Two Arrays length is different!");for(var b=[],a=0;a<this.length;a++)b[a]=this[a]^c[a];return b};Number.prototype.toHexStr=function(){if(this>255)return new Error("the value is out of range");var a=this.toString(16).toUpperCase();if(a.length==1)a="0"+a;return a};String.prototype.str2HexStr=function(){for(var b=[],a=this.length-1;a>=0;a--)b[a]=String.charCodeAt(this[a]).toHexStr();return b.join("")};String.prototype.hexStr2Str=function(){if(this.length%2!=0)return alert("The Length of String is illeagality!");for(var b=[],a=0;a<this.length/2;a++)b[a]=String.fromCharCode(parseInt(this.substr(a*2,2),16));return b.join("")};String.prototype.xorHexString=function(b){var a=this.hexStr2NumberArray();return a.xorArray(b.hexStr2NumberArray()).toHexStr()};String.prototype.str2NumberArray=function(){for(var b=[],a=this.length-1;a>=0;a--)b.push(String.charCodeAt(this[a]));return b};String.prototype.hexStr2NumberArray=function(){if(this.length%2!=0)return alert("The Length of String is illeagality!");for(var b=[],a=0;a<this.length/2;a++)b.push(parseInt(this.substr(a*2,2),16));return b};String.prototype.toArray=function(){for(var b=new Array(this.length),a=this.length-1;a>=0;a--)b[a]=this.charCodeAt(a);return b};function UnionPin(){var a="v1.1.0";UnionPin.getVersion=function(){return a}}UnionPin.prototype.encryptPinBySM2=function(j,a,e){var f=this.getFilledPin(j,e),h=a.substr(0,64),i=a.substr(64),d=SM2CipherMode.C1C3C2,b=new SM2Cipher(d),g=b.CreatePoint(h,i),c=b.Encrypt(g,f);return c.toUpperCase()};UnionPin.prototype.encryptPinByRSA=function(f,e,b){var d=this.getFilledPin(f,b),a=new JSEncrypt;a.setPublicKey(e);var c=a.encrypt(d);return c};UnionPin.prototype.getFilledPin=function(b,a){return!this.checkPin(b)||!this.checkFilledMode(a)?"":this.getFilledStyle("CharF")===a?this.filledPinByCharF(b):this.getFilledStyle("RandomXOR")===a?this.filledPinByRandom(b):alert("Error :: \u65e0\u6b64\u7c7b\u586b\u5145\u65b9\u5f0f\uff01")};UnionPin.prototype.getPin=function(a,c){if(typeof a!=="string"||typeof c!=="number"){alert("Error :: \u53c2\u6570\u7c7b\u578b\u9519\u8bef\uff01");return""}var b=0,d="";if(this.getFilledStyle("CharF")===c){b=parseInt(a.substr(0,2),16);return a.substr(2,b)}else if(this.getFilledStyle("RandomXOR")===c){b=parseInt(a.substr(0,4).hexStr2Str(),16);d=a.substr(4,b*2);var e=a.substr(-b*2,b*2);return d.xorHexString(e).hexStr2Str()}};UnionPin.prototype.getFilledStyle=function(b){var a={CharF:1,RandomXOR:0};return a[b]};UnionPin.prototype.getRandom=function(b){for(var c=new Array(b),a=b-1;a>=0;a--)c[a]=Math.floor(Math.random()*224+1);return c};UnionPin.prototype.filledPinByRandom=function(a){if(!this.checkPin(a))return"";for(var c=a.toArray(),f=a.length.toHexStr().toArray(),d=this.getRandom(32-2-a.length),b=a.length-1,e=d.length-1;b>=0;b--,e--)c[b]=c[b]^d[e];var g=f.concat(c,d);return"30416C69757A686F75313233AD58EBFBBAA61D96F2CBE58B11D979153D39EC5A".hexStr2NumberArray()};UnionPin.prototype.filledPinByCharF=function(a){if(!this.checkPin(a))return"";var c=a.length,b=""+c.toHexStr(),d="FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF";b+=a+d.substr(0,32-2-c);return b.toArray()};UnionPin.prototype.checkPin=function(a){if(typeof a!=="string"){alert("PinError :: \u9519\u8bef\u7684\u6570\u636e\u7c7b\u578b\uff01");return false}if(a.length<4||a.length>12){alert("PinError :: Pin\u957f\u5ea6\u5927\u4e8e12\u6216\u5c0f\u4e8e4\uff01");return false}return true};UnionPin.prototype.checkFilledMode=function(a){if(typeof a!=="number"){alert("FilledModeError :: \u9519\u8bef\u7684\u6570\u636e\u7c7b\u578b\uff01");return false}return true};/* JSEncrypt v2.3.1 | https://unpkg.com/jsencrypt@2.3.1/LICENSE.txt */
(function(b,a){if(typeof define==="function"&&define.amd)define(["exports"],a);else if(typeof exports==="object"&&typeof exports.nodeName!=="string")a(module.exports);else a(b)})(this,function(zc){var l,Bc=0xdeadbeefcafe,O=(Bc&16777215)==15715070;function a(a,b,c){if(a!=null)if("number"==typeof a)this.fromNumber(a,b,c);else if(b==null&&"string"!=typeof a)this.fromString(a,256);else this.fromString(a,b)}function b(){return new a(null)}function Wc(e,g,d,b,a,f){while(--f>=0){var c=g*this[e++]+d[b]+a;a=Math.floor(c/67108864);d[b++]=c&67108863}return a}function Xc(f,j,i,g,b,k){var d=j&32767,c=j>>15;while(--k>=0){var a=this[f]&32767,e=this[f++]>>15,h=c*a+e*d;a=d*a+((h&32767)<<15)+i[g]+(b&1073741823);b=(a>>>30)+(h>>>15)+c*e+(b>>>30);i[g++]=a&1073741823}return b}function Yc(f,j,i,g,b,k){var d=j&16383,c=j>>14;while(--k>=0){var a=this[f]&16383,e=this[f++]>>14,h=c*a+e*d;a=d*a+((h&16383)<<14)+i[g]+b;b=(a>>28)+(h>>14)+c*e;i[g++]=a&268435455}return b}if(O&&navigator.appName=="Microsoft Internet Explorer"){a.prototype.am=Xc;l=30}else if(O&&navigator.appName!="Netscape"){a.prototype.am=Wc;l=26}else{a.prototype.am=Yc;l=28}a.prototype.DB=l;a.prototype.DM=(1<<l)-1;a.prototype.DV=1<<l;var E=52;a.prototype.FV=Math.pow(2,E);a.prototype.F1=E-l;a.prototype.F2=2*l-E;var Hc="0123456789abcdefghijklmnopqrstuvwxyz",y=[],r,h;r="0".charCodeAt(0);for(h=0;h<=9;++h)y[r++]=h;r="a".charCodeAt(0);for(h=10;h<36;++h)y[r++]=h;r="A".charCodeAt(0);for(h=10;h<36;++h)y[r++]=h;function j(a){return Hc.charAt(a)}function N(c,b){var a=y[c.charCodeAt(b)];return a==null?-1:a}function bc(b){for(var a=this.t-1;a>=0;--a)b[a]=this[a];b.t=this.t;b.s=this.s}function Sb(a){this.t=1;this.s=a<0?-1:0;if(a>0)this[0]=a;else if(a<-1)this[0]=a+this.DV;else this.t=0}function m(c){var a=b();a.fromInt(c);return a}function eb(e,d){var c;if(d==16)c=4;else if(d==8)c=3;else if(d==256)c=8;else if(d==2)c=1;else if(d==32)c=5;else if(d==4)c=2;else{this.fromRadix(e,d);return}this.t=0;this.s=0;var g=e.length,h=false,b=0;while(--g>=0){var f=c==8?e[g]&255:N(e,g);if(f<0){if(e.charAt(g)=="-")h=true;continue}h=false;if(b==0)this[this.t++]=f;else if(b+c>this.DB){this[this.t-1]|=(f&(1<<this.DB-b)-1)<<b;this[this.t++]=f>>this.DB-b}else this[this.t-1]|=f<<b;b+=c;if(b>=this.DB)b-=this.DB}if(c==8&&(e[0]&128)!=0){this.s=-1;if(b>0)this[this.t-1]|=(1<<this.DB-b)-1<<b}this.clamp();h&&a.ZERO.subTo(this,this)}function qc(){var a=this.s&this.DM;while(this.t>0&&this[this.t-1]==a)--this.t}function Vb(d){if(this.s<0)return"-"+this.negate().toString(d);var a;if(d==16)a=4;else if(d==8)a=3;else if(d==2)a=1;else if(d==32)a=5;else if(d==4)a=2;else return this.toRadix(d);var h=(1<<a)-1,e,f=false,g="",c=this.t,b=this.DB-c*this.DB%a;if(c-->0){if(b<this.DB&&(e=this[c]>>b)>0){f=true;g=j(e)}while(c>=0){if(b<a){e=(this[c]&(1<<b)-1)<<a-b;e|=this[--c]>>(b+=this.DB-a)}else{e=this[c]>>(b-=a)&h;if(b<=0){b+=this.DB;--c}}if(e>0)f=true;if(f)g+=j(e)}}return f?g:"0"}function oc(){var c=b();a.ZERO.subTo(this,c);return c}function Ic(){return this.s<0?this.negate():this}function Bb(c){var a=this.s-c.s;if(a!=0)return a;var b=this.t;a=b-c.t;if(a!=0)return this.s<0?-a:a;while(--b>=0)if((a=this[b]-c[b])!=0)return a;return 0}function z(b){var c=1,a;if((a=b>>>16)!=0){b=a;c+=16}if((a=b>>8)!=0){b=a;c+=8}if((a=b>>4)!=0){b=a;c+=4}if((a=b>>2)!=0){b=a;c+=2}if((a=b>>1)!=0){b=a;c+=1}return c}function zb(){return this.t<=0?0:this.DB*(this.t-1)+z(this[this.t-1]^this.s&this.DM)}function qb(c,b){for(var a=this.t-1;a>=0;--a)b[a+c]=this[a];for(a=c-1;a>=0;--a)b[a]=0;b.t=this.t+c;b.s=this.s}function sb(b,c){for(var a=b;a<this.t;++a)c[a-b]=this[a];c.t=Math.max(this.t-b,0);c.s=this.s}function Fb(g,b){for(var d=g%this.DB,f=this.DB-d,h=(1<<f)-1,c=Math.floor(g/this.DB),e=this.s<<d&this.DM,a=this.t-1;a>=0;--a){b[a+c+1]=this[a]>>f|e;e=(this[a]&h)<<d}for(a=c-1;a>=0;--a)b[a]=0;b[c]=e;b.t=this.t+c+1;b.s=this.s;b.clamp()}function Gb(g,a){a.s=this.s;var b=Math.floor(g/this.DB);if(b>=this.t){a.t=0;return}var d=g%this.DB,e=this.DB-d,f=(1<<d)-1;a[0]=this[b]>>d;for(var c=b+1;c<this.t;++c){a[c-b-1]|=(this[c]&f)<<e;a[c-b]=this[c]>>d}if(d>0)a[this.t-b-1]|=(this.s&f)<<e;a.t=this.t-b;a.clamp()}function rc(d,c){var b=0,a=0,e=Math.min(d.t,this.t);while(b<e){a+=this[b]-d[b];c[b++]=a&this.DM;a>>=this.DB}if(d.t<this.t){a-=d.s;while(b<this.t){a+=this[b];c[b++]=a&this.DM;a>>=this.DB}a+=this.s}else{a+=this.s;while(b<d.t){a-=d[b];c[b++]=a&this.DM;a>>=this.DB}a-=d.s}c.s=a<0?-1:0;if(a<-1)c[b++]=this.DV+a;else if(a>0)c[b++]=a;c.t=b;c.clamp()}function fb(f,c){var d=this.abs(),e=f.abs(),b=d.t;c.t=b+e.t;while(--b>=0)c[b]=0;for(b=0;b<e.t;++b)c[b+d.t]=d.am(0,e[b],c,b,0,d.t);c.s=0;c.clamp();this.s!=f.s&&a.ZERO.subTo(c,c)}function Hb(c){var b=this.abs(),a=c.t=2*b.t;while(--a>=0)c[a]=0;for(a=0;a<b.t-1;++a){var d=b.am(a,b[a],c,2*a,0,1);if((c[a+b.t]+=b.am(a+1,2*b[a],c,2*a+1,d,b.t-a-1))>=b.DV){c[a+b.t]-=b.DV;c[a+b.t+1]=1}}if(c.t>0)c[c.t-1]+=b.am(a,b[a],c,2*a,0,1);c.s=0;c.clamp()}function Db(q,f,c){var h=q.abs();if(h.t<=0)return;var l=this.abs();if(l.t<h.t){f!=null&&f.fromInt(0);c!=null&&this.copyTo(c);return}if(c==null)c=b();var d=b(),o=this.s,t=q.s,j=this.DB-z(h[h.t-1]);if(j>0){h.lShiftTo(j,d);l.lShiftTo(j,c)}else{h.copyTo(d);l.copyTo(c)}var e=d.t,n=d[e-1];if(n==0)return;var p=n*(1<<this.F1)+(e>1?d[e-2]>>this.F2:0),r=this.FV/p,s=(1<<this.F1)/p,u=1<<this.F2,i=c.t,k=i-e,g=f==null?b():f;d.dlShiftTo(k,g);if(c.compareTo(g)>=0){c[c.t++]=1;c.subTo(g,c)}a.ONE.dlShiftTo(e,g);g.subTo(d,d);while(d.t<e)d[d.t++]=0;while(--k>=0){var m=c[--i]==n?this.DM:Math.floor(c[i]*r+(c[i-1]+u)*s);if((c[i]+=d.am(0,m,c,k,0,e))<m){d.dlShiftTo(k,g);c.subTo(g,c);while(c[i]<--m)c.subTo(g,c)}}if(f!=null){c.drShiftTo(e,f);o!=t&&a.ZERO.subTo(f,f)}c.t=e;c.clamp();j>0&&c.rShiftTo(j,c);o<0&&a.ZERO.subTo(c,c)}function Oc(d){var c=b();this.abs().divRemTo(d,null,c);this.s<0&&c.compareTo(a.ZERO)>0&&d.subTo(c,c);return c}function o(a){this.m=a}function vc(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function yc(a){return a}function xc(a){a.divRemTo(this.m,null,a)}function Cc(b,c,a){b.multiplyTo(c,a);this.reduce(a)}function Dc(b,a){b.squareTo(a);this.reduce(a)}o.prototype.convert=vc;o.prototype.revert=yc;o.prototype.reduce=xc;o.prototype.mulTo=Cc;o.prototype.sqrTo=Dc;function Eb(){if(this.t<1)return 0;var b=this[0];if((b&1)==0)return 0;var a=b&3;a=a*(2-(b&15)*a)&15;a=a*(2-(b&255)*a)&255;a=a*(2-((b&65535)*a&65535))&65535;a=a*(2-b*a%this.DV)%this.DV;return a>0?this.DV-a:-a}function n(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}function Kb(d){var c=b();d.abs().dlShiftTo(this.m.t,c);c.divRemTo(this.m,null,c);d.s<0&&c.compareTo(a.ZERO)>0&&this.m.subTo(c,c);return c}function Xb(c){var a=b();c.copyTo(a);this.reduce(a);return a}function Wb(a){while(a.t<=this.mt2)a[a.t++]=0;for(var c=0;c<this.m.t;++c){var b=a[c]&32767,d=b*this.mpl+((b*this.mph+(a[c]>>15)*this.mpl&this.um)<<15)&a.DM;b=c+this.m.t;a[b]+=this.m.am(0,d,a,c,0,this.m.t);while(a[b]>=a.DV){a[b]-=a.DV;a[++b]++}}a.clamp();a.drShiftTo(this.m.t,a);a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function gc(b,a){b.squareTo(a);this.reduce(a)}function fc(b,c,a){b.multiplyTo(c,a);this.reduce(a)}n.prototype.convert=Kb;n.prototype.revert=Xb;n.prototype.reduce=Wb;n.prototype.mulTo=fc;n.prototype.sqrTo=gc;function cc(){return(this.t>0?this[0]&1:this.s)==0}function Ac(e,f){if(e>4294967295||e<1)return a.ONE;var c=b(),d=b(),g=f.convert(this),h=z(e)-1;g.copyTo(c);while(--h>=0){f.sqrTo(c,d);if((e&1<<h)>0)f.mulTo(d,g,c);else{var i=c;c=d;d=i}}return f.revert(c)}function Cb(c,a){var b;if(c<256||a.isEven())b=new o(a);else b=new n(a);return this.exp(c,b)}a.prototype.copyTo=bc;a.prototype.fromInt=Sb;a.prototype.fromString=eb;a.prototype.clamp=qc;a.prototype.dlShiftTo=qb;a.prototype.drShiftTo=sb;a.prototype.lShiftTo=Fb;a.prototype.rShiftTo=Gb;a.prototype.subTo=rc;a.prototype.multiplyTo=fb;a.prototype.squareTo=Hb;a.prototype.divRemTo=Db;a.prototype.invDigit=Eb;a.prototype.isEven=cc;a.prototype.exp=Ac;a.prototype.toString=Vb;a.prototype.negate=oc;a.prototype.abs=Ic;a.prototype.compareTo=Bb;a.prototype.bitLength=zb;a.prototype.mod=Oc;a.prototype.modPowInt=Cb;a.ZERO=m(0);a.ONE=m(1);function wc(){var a=b();this.copyTo(a);return a}function Qb(){if(this.s<0){if(this.t==1)return this[0]-this.DV;else if(this.t==0)return-1}else if(this.t==1)return this[0];else if(this.t==0)return 0;return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Ab(){return this.t==0?this.s:this[0]<<24>>24}function vb(){return this.t==0?this.s:this[0]<<16>>16}function pb(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function tc(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Tb(a){if(a==null)a=10;if(this.signum()==0||a<2||a>36)return"0";var h=this.chunkSize(a),f=Math.pow(a,h),g=m(f),c=b(),d=b(),e="";this.divRemTo(g,c,d);while(c.signum()>0){e=(f+d.intValue()).toString(a).substr(1)+e;c.divRemTo(g,c,d)}return d.intValue().toString(a)+e}function tb(f,b){this.fromInt(0);if(b==null)b=10;for(var g=this.chunkSize(b),j=Math.pow(b,g),h=false,e=0,c=0,d=0;d<f.length;++d){var i=N(f,d);if(i<0){if(f.charAt(d)=="-"&&this.signum()==0)h=true;continue}c=b*c+i;if(++e>=g){this.dMultiply(j);this.dAddOffset(c,0);e=0;c=0}}if(e>0){this.dMultiply(Math.pow(b,e));this.dAddOffset(c,0)}h&&a.ZERO.subTo(this,this)}function db(b,d,f){if("number"==typeof d)if(b<2)this.fromInt(1);else{this.fromNumber(b,f);!this.testBit(b-1)&&this.bitwiseTo(a.ONE.shiftLeft(b-1),A,this);this.isEven()&&this.dAddOffset(1,0);while(!this.isProbablePrime(d)){this.dAddOffset(2,0);this.bitLength()>b&&this.subTo(a.ONE.shiftLeft(b-1),this)}}else{var c=[],e=b&7;c.length=(b>>3)+1;d.nextBytes(c);if(e>0)c[0]&=(1<<e)-1;else c[0]=0;this.fromString(c,256)}}function gb(){var c=this.t,e=[];e[0]=this.s;var a=this.DB-c*this.DB%8,b,d=0;if(c-->0){if(a<this.DB&&(b=this[c]>>a)!=(this.s&this.DM)>>a)e[d++]=b|this.s<<this.DB-a;while(c>=0){if(a<8){b=(this[c]&(1<<a)-1)<<8-a;b|=this[--c]>>(a+=this.DB-8)}else{b=this[c]>>(a-=8)&255;if(a<=0){a+=this.DB;--c}}if((b&128)!=0)b|=-256;if(d==0&&(this.s&128)!=(b&128))++d;if(d>0||b!=this.s)e[d++]=b}}return e}function mc(a){return this.compareTo(a)==0}function Nc(a){return this.compareTo(a)<0?this:a}function Mc(a){return this.compareTo(a)>0?this:a}function nb(b,d,c){for(var e,f=Math.min(b.t,this.t),a=0;a<f;++a)c[a]=d(this[a],b[a]);if(b.t<this.t){e=b.s&this.DM;for(a=f;a<this.t;++a)c[a]=d(this[a],e);c.t=this.t}else{e=this.s&this.DM;for(a=f;a<b.t;++a)c[a]=d(e,b[a]);c.t=b.t}c.s=d(this.s,b.s);c.clamp()}function Gc(a,b){return a&b}function Kc(c){var a=b();this.bitwiseTo(c,Gc,a);return a}function A(a,b){return a|b}function Tc(c){var a=b();this.bitwiseTo(c,A,a);return a}function M(a,b){return a^b}function Rc(c){var a=b();this.bitwiseTo(c,M,a);return a}function I(a,b){return a&~b}function kc(c){var a=b();this.bitwiseTo(c,I,a);return a}function Pc(){for(var c=b(),a=0;a<this.t;++a)c[a]=this.DM&~this[a];c.t=this.t;c.s=~this.s;return c}function Jb(a){var c=b();if(a<0)this.rShiftTo(-a,c);else this.lShiftTo(a,c);return c}function ub(a){var c=b();if(a<0)this.lShiftTo(-a,c);else this.rShiftTo(a,c);return c}function Vc(a){if(a==0)return-1;var b=0;if((a&65535)==0){a>>=16;b+=16}if((a&255)==0){a>>=8;b+=8}if((a&15)==0){a>>=4;b+=4}if((a&3)==0){a>>=2;b+=2}if((a&1)==0)++b;return b}function U(){for(var a=0;a<this.t;++a)if(this[a]!=0)return a*this.DB+Vc(this[a]);return this.s<0?this.t*this.DB:-1}function Uc(a){var b=0;while(a!=0){a&=a-1;++b}return b}function Ob(){for(var b=0,c=this.s&this.DM,a=0;a<this.t;++a)b+=Uc(this[a]^c);return b}function ec(b){var a=Math.floor(b/this.DB);return a>=this.t?this.s!=0:(this[a]&1<<b%this.DB)!=0}function ob(d,c){var b=a.ONE.shiftLeft(d);this.bitwiseTo(b,c,b);return b}function sc(a){return this.changeBit(a,A)}function Pb(a){return this.changeBit(a,I)}function ac(a){return this.changeBit(a,M)}function pc(d,c){var b=0,a=0,e=Math.min(d.t,this.t);while(b<e){a+=this[b]+d[b];c[b++]=a&this.DM;a>>=this.DB}if(d.t<this.t){a+=d.s;while(b<this.t){a+=this[b];c[b++]=a&this.DM;a>>=this.DB}a+=this.s}else{a+=this.s;while(b<d.t){a+=d[b];c[b++]=a&this.DM;a>>=this.DB}a+=d.s}c.s=a<0?-1:0;if(a>0)c[b++]=a;else if(a<-1)c[b++]=this.DV+a;c.t=b;c.clamp()}function Jc(c){var a=b();this.addTo(c,a);return a}function Ub(c){var a=b();this.subTo(c,a);return a}function Rb(c){var a=b();this.multiplyTo(c,a);return a}function uc(){var a=b();this.squareTo(a);return a}function lc(c){var a=b();this.divRemTo(c,a,null);return a}function Ib(c){var a=b();this.divRemTo(c,null,a);return a}function R(d){var a=b(),c=b();this.divRemTo(d,a,c);return[a,c]}function rb(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()}function cb(b,a){if(b==0)return;while(this.t<=a)this[this.t++]=0;this[a]+=b;while(this[a]>=this.DV){this[a]-=this.DV;if(++a>=this.t)this[this.t++]=0;++this[a]}}function t(){}function P(a){return a}function Ec(b,c,a){b.multiplyTo(c,a)}function Fc(b,a){b.squareTo(a)}t.prototype.convert=P;t.prototype.revert=P;t.prototype.mulTo=Ec;t.prototype.sqrTo=Fc;function Qc(a){return this.exp(a,new t)}function S(c,e,b){var a=Math.min(this.t+c.t,e);b.s=0;b.t=a;while(a>0)b[--a]=0;for(var d=b.t-this.t;a<d;++a)b[a+this.t]=this.am(0,c[a],b,a,0,this.t);for(d=Math.min(c.t,e);a<d;++a)this.am(0,c[a],b,a,0,e-a);b.clamp()}function T(d,c,b){--c;var a=b.t=this.t+d.t-c;b.s=0;while(--a>=0)b[a]=0;for(a=Math.max(c-this.t,0);a<d.t;++a)b[this.t+a-c]=this.am(c-a,d[a],b,0,0,this.t+a-c);b.clamp();b.drShiftTo(1,b)}function p(c){this.r2=b();this.q3=b();a.ONE.dlShiftTo(2*c.t,this.r2);this.mu=this.r2.divide(c);this.m=c}function Y(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);else if(a.compareTo(this.m)<0)return a;else{var c=b();a.copyTo(c);this.reduce(c);return c}}function bb(a){return a}function ab(a){a.drShiftTo(this.m.t-1,this.r2);if(a.t>this.m.t+1){a.t=this.m.t+1;a.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(a.compareTo(this.r2)<0)a.dAddOffset(1,this.m.t+1);a.subTo(this.r2,a);while(a.compareTo(this.m)>=0)a.subTo(this.m,a)}function lb(b,a){b.squareTo(a);this.reduce(a)}function kb(b,c,a){b.multiplyTo(c,a);this.reduce(a)}p.prototype.convert=Y;p.prototype.revert=bb;p.prototype.reduce=ab;p.prototype.mulTo=kb;p.prototype.sqrTo=lb;function nc(i,q){var a=i.bitLength(),h,c=m(1),d;if(a<=0)return c;else if(a<18)h=1;else if(a<48)h=3;else if(a<144)h=4;else if(a<768)h=5;else h=6;if(a<8)d=new o(q);else if(q.isEven())d=new p(q);else d=new n(q);var j=[],e=3,l=h-1,u=(1<<h)-1;j[1]=d.convert(this);if(h>1){var t=b();d.sqrTo(j[1],t);while(e<=u){j[e]=b();d.mulTo(t,j[e-2],j[e]);e+=2}}var f=i.t-1,k,s=true,g=b(),r;a=z(i[f])-1;while(f>=0){if(a>=l)k=i[f]>>a-l&u;else{k=(i[f]&(1<<a+1)-1)<<l-a;if(f>0)k|=i[f-1]>>this.DB+a-l}e=h;while((k&1)==0){k>>=1;--e}if((a-=e)<0){a+=this.DB;--f}if(s){j[k].copyTo(c);s=false}else{while(e>1){d.sqrTo(c,g);d.sqrTo(g,c);e-=2}if(e>0)d.sqrTo(c,g);else{r=c;c=g;g=r}d.mulTo(g,j[k],c)}while(f>=0&&(i[f]&1<<a)==0){d.sqrTo(c,g);r=c;c=g;g=r;if(--a<0){a=this.DB-1;--f}}}return d.revert(c)}function Lc(e){var b=this.s<0?this.negate():this.clone(),a=e.s<0?e.negate():e.clone();if(b.compareTo(a)<0){var f=b;b=a;a=f}var d=b.getLowestSetBit(),c=a.getLowestSetBit();if(c<0)return b;if(d<c)c=d;if(c>0){b.rShiftTo(c,b);a.rShiftTo(c,a)}while(b.signum()>0){(d=b.getLowestSetBit())>0&&b.rShiftTo(d,b);(d=a.getLowestSetBit())>0&&a.rShiftTo(d,a);if(b.compareTo(a)>=0){b.subTo(a,b);b.rShiftTo(1,b)}else{a.subTo(b,a);a.rShiftTo(1,a)}}c>0&&a.lShiftTo(c,a);return a}function dc(a){if(a<=0)return 0;var d=this.DV%a,b=this.s<0?a-1:0;if(this.t>0)if(d==0)b=this[0]%a;else for(var c=this.t-1;c>=0;--c)b=(d*b+this[c])%a;return b}function mb(d){var i=d.isEven();if(this.isEven()&&i||d.signum()==0)return a.ZERO;var g=d.clone(),h=this.clone(),e=m(1),c=m(0),f=m(0),b=m(1);while(g.signum()!=0){while(g.isEven()){g.rShiftTo(1,g);if(i){if(!e.isEven()||!c.isEven()){e.addTo(this,e);c.subTo(d,c)}e.rShiftTo(1,e)}else!c.isEven()&&c.subTo(d,c);c.rShiftTo(1,c)}while(h.isEven()){h.rShiftTo(1,h);if(i){if(!f.isEven()||!b.isEven()){f.addTo(this,f);b.subTo(d,b)}f.rShiftTo(1,f)}else!b.isEven()&&b.subTo(d,b);b.rShiftTo(1,b)}if(g.compareTo(h)>=0){g.subTo(h,g);i&&e.subTo(f,e);c.subTo(b,c)}else{h.subTo(g,h);i&&f.subTo(e,f);b.subTo(c,b)}}if(h.compareTo(a.ONE)!=0)return a.ZERO;if(b.compareTo(d)>=0)return b.subtract(d);if(b.signum()<0)b.addTo(d,b);else return b;return b.signum()<0?b.add(d):b}var f=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Sc=(1<<26)/f[f.length-1];function V(e){var a,b=this.abs();if(b.t==1&&b[0]<=f[f.length-1]){for(a=0;a<f.length;++a)if(b[0]==f[a])return true;return false}if(b.isEven())return false;a=1;while(a<f.length){var c=f[a],d=a+1;while(d<f.length&&c<Sc)c*=f[d++];c=b.modInt(c);while(a<d)if(c%f[a++]==0)return false}return b.millerRabin(e)}function Z(e){var d=this.subtract(a.ONE),g=d.getLowestSetBit();if(g<=0)return false;var k=d.shiftRight(g);e=e+1>>1;if(e>f.length)e=f.length;for(var h=b(),i=0;i<e;++i){h.fromInt(f[Math.floor(Math.random()*f.length)]);var c=h.modPow(k,this);if(c.compareTo(a.ONE)!=0&&c.compareTo(d)!=0){var j=1;while(j++<g&&c.compareTo(d)!=0){c=c.modPowInt(2,this);if(c.compareTo(a.ONE)==0)return false}if(c.compareTo(d)!=0)return false}}return true}a.prototype.chunkSize=pb;a.prototype.toRadix=Tb;a.prototype.fromRadix=tb;a.prototype.fromNumber=db;a.prototype.bitwiseTo=nb;a.prototype.changeBit=ob;a.prototype.addTo=pc;a.prototype.dMultiply=rb;a.prototype.dAddOffset=cb;a.prototype.multiplyLowerTo=S;a.prototype.multiplyUpperTo=T;a.prototype.modInt=dc;a.prototype.millerRabin=Z;a.prototype.clone=wc;a.prototype.intValue=Qb;a.prototype.byteValue=Ab;a.prototype.shortValue=vb;a.prototype.signum=tc;a.prototype.toByteArray=gb;a.prototype.equals=mc;a.prototype.min=Nc;a.prototype.max=Mc;a.prototype.and=Kc;a.prototype.or=Tc;a.prototype.xor=Rc;a.prototype.andNot=kc;a.prototype.not=Pc;a.prototype.shiftLeft=Jb;a.prototype.shiftRight=ub;a.prototype.getLowestSetBit=U;a.prototype.bitCount=Ob;a.prototype.testBit=ec;a.prototype.setBit=sc;a.prototype.clearBit=Pb;a.prototype.flipBit=ac;a.prototype.add=Jc;a.prototype.subtract=Ub;a.prototype.multiply=Rb;a.prototype.divide=lc;a.prototype.remainder=Ib;a.prototype.divideAndRemainder=R;a.prototype.modPow=nc;a.prototype.modInverse=mb;a.prototype.pow=Qc;a.prototype.gcd=Lc;a.prototype.isProbablePrime=V;a.prototype.square=uc;function C(){this.i=0;this.j=0;this.S=[]}function ic(c){for(var b,d,a=0;a<256;++a)this.S[a]=a;b=0;for(a=0;a<256;++a){b=b+this.S[a]+c[a%c.length]&255;d=this.S[a];this.S[a]=this.S[b];this.S[b]=d}this.i=0;this.j=0}function jc(){var a;this.i=this.i+1&255;this.j=this.j+this.S[this.i]&255;a=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=a;return this.S[a+this.S[this.i]&255]}C.prototype.init=ic;C.prototype.next=jc;function hb(){return new C}var J=256,x,k,i;if(k==null){k=[];i=0;var B;if(window.crypto&&window.crypto.getRandomValues){var H=new Uint32Array(256);window.crypto.getRandomValues(H);for(B=0;B<H.length;++B)k[i++]=H[B]&255}var u=function(a){this.count=this.count||0;if(this.count>=256||i>=J){if(window.removeEventListener)window.removeEventListener("mousemove",u,false);else window.detachEvent&&window.detachEvent("onmousemove",u);return}try{var b=a.x+a.y;k[i++]=b&255;this.count+=1}catch(c){}};if(window.addEventListener)window.addEventListener("mousemove",u,false);else window.attachEvent&&window.attachEvent("onmousemove",u)}function wb(){if(x==null){x=hb();while(i<J){var a=Math.floor(65536*Math.random());k[i++]=a&255}x.init(k);for(i=0;i<k.length;++i)k[i]=0;i=0}return x.next()}function ib(b){for(var a=0;a<b.length;++a)b[a]=wb()}function w(){}w.prototype.nextBytes=ib;function e(b,c){return new a(b,c)}function hc(f,b){if(b<f.length+11){console.error("Message too long for RSA");return null}var c=[],g=f.length-1;while(g>=0&&b>0){var d=f.charCodeAt(g--);if(d<128)c[--b]=d;else if(d>127&&d<2048){c[--b]=d&63|128;c[--b]=d>>6|192}else{c[--b]=d&63|128;c[--b]=d>>6&63|128;c[--b]=d>>12|224}}c[--b]=0;var h=new w,e=[];while(b>2){e[0]=0;while(e[0]==0)h.nextBytes(e);c[--b]=e[0]}c[--b]=2;c[--b]=0;return new a(c)}function d(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null}function yb(b,a){if(b!=null&&a!=null&&b.length>0&&a.length>0){this.n=e(b,16);this.e=parseInt(a,16)}else console.error("Invalid RSA public key")}function Mb(a){return a.modPowInt(this.e,this.n)}function Zb(d){var c=hc(d,this.n.bitLength()+7>>3);if(c==null)return null;var b=this.doPublic(c);if(b==null)return null;var a=b.toString(16);return(a.length&1)==0?a:"0"+a}d.prototype.doPublic=Mb;d.prototype.setPublic=yb;d.prototype.encrypt=Zb;function Lb(e,f){var b=e.toByteArray(),a=0;while(a<b.length&&b[a]==0)++a;if(b.length-a!=f-1||b[a]!=2)return null;++a;while(b[a]!=0)if(++a>=b.length)return null;var d="";while(++a<b.length){var c=b[a]&255;if(c<128)d+=String.fromCharCode(c);else if(c>191&&c<224){d+=String.fromCharCode((c&31)<<6|b[a+1]&63);++a}else{d+=String.fromCharCode((c&15)<<12|(b[a+1]&63)<<6|b[a+2]&63);a+=2}}return d}function jb(b,a,c){if(b!=null&&a!=null&&b.length>0&&a.length>0){this.n=e(b,16);this.e=parseInt(a,16);this.d=e(c,16)}else console.error("Invalid RSA private key")}function X(b,a,g,h,i,c,d,f){if(b!=null&&a!=null&&b.length>0&&a.length>0){this.n=e(b,16);this.e=parseInt(a,16);this.d=e(g,16);this.p=e(h,16);this.q=e(i,16);this.dmp1=e(c,16);this.dmq1=e(d,16);this.coeff=e(f,16)}else console.error("Invalid RSA private key")}function Nb(h,i){var d=new w,g=h>>1;this.e=parseInt(i,16);for(var b=new a(i,16);true;){for(;true;){this.p=new a(h-g,1,d);if(this.p.subtract(a.ONE).gcd(b).compareTo(a.ONE)==0&&this.p.isProbablePrime(10))break}for(;true;){this.q=new a(g,1,d);if(this.q.subtract(a.ONE).gcd(b).compareTo(a.ONE)==0&&this.q.isProbablePrime(10))break}if(this.p.compareTo(this.q)<=0){var j=this.p;this.p=this.q;this.q=j}var e=this.p.subtract(a.ONE),f=this.q.subtract(a.ONE),c=e.multiply(f);if(c.gcd(b).compareTo(a.ONE)==0){this.n=this.p.multiply(this.q);this.d=b.modInverse(c);this.dmp1=this.d.mod(e);this.dmq1=this.d.mod(f);this.coeff=this.q.modInverse(this.p);break}}}function xb(c){if(this.p==null||this.q==null)return c.modPow(this.d,this.n);var a=c.mod(this.p).modPow(this.dmp1,this.p),b=c.mod(this.q).modPow(this.dmq1,this.q);while(a.compareTo(b)<0)a=a.add(this.p);return a.subtract(b).multiply(this.coeff).mod(this.p).multiply(this.q).add(b)}function Yb(b){var c=e(b,16),a=this.doPrivate(c);return a==null?null:Lb(a,this.n.bitLength()+7>>3)}d.prototype.doPrivate=xb;d.prototype.setPrivate=jb;d.prototype.setPrivateEx=X;d.prototype.generate=Nb;d.prototype.decrypt=Yb;(function(){var e=function(h,i,j){var f=new w,g=h>>1;this.e=parseInt(i,16);var d=new a(i,16),c=this,e=function(){var l=function(){if(c.p.compareTo(c.q)<=0){var h=c.p;c.p=c.q;c.q=h}var f=c.p.subtract(a.ONE),g=c.q.subtract(a.ONE),b=f.multiply(g);if(b.gcd(d).compareTo(a.ONE)==0){c.n=c.p.multiply(c.q);c.d=d.modInverse(b);c.dmp1=c.d.mod(f);c.dmq1=c.d.mod(g);c.coeff=c.q.modInverse(c.p);setTimeout(function(){j()},0)}else setTimeout(e,0)},k=function(){c.q=b();c.q.fromNumberAsync(g,1,f,function(){c.q.subtract(a.ONE).gcda(d,function(b){if(b.compareTo(a.ONE)==0&&c.q.isProbablePrime(10))setTimeout(l,0);else setTimeout(k,0)})})},i=function(){c.p=b();c.p.fromNumberAsync(h-g,1,f,function(){c.p.subtract(a.ONE).gcda(d,function(b){if(b.compareTo(a.ONE)==0&&c.p.isProbablePrime(10))setTimeout(k,0);else setTimeout(i,0)})})};setTimeout(i,0)};setTimeout(e,0)};d.prototype.generateAsync=e;var f=function(e,f){var b=this.s<0?this.negate():this.clone(),a=e.s<0?e.negate():e.clone();if(b.compareTo(a)<0){var h=b;b=a;a=h}var d=b.getLowestSetBit(),c=a.getLowestSetBit();if(c<0){f(b);return}if(d<c)c=d;if(c>0){b.rShiftTo(c,b);a.rShiftTo(c,a)}var g=function(){(d=b.getLowestSetBit())>0&&b.rShiftTo(d,b);(d=a.getLowestSetBit())>0&&a.rShiftTo(d,a);if(b.compareTo(a)>=0){b.subTo(a,b);b.rShiftTo(1,b)}else{a.subTo(b,a);a.rShiftTo(1,a)}if(!(b.signum()>0)){c>0&&a.lShiftTo(c,a);setTimeout(function(){f(a)},0)}else setTimeout(g,0)};setTimeout(g,10)};a.prototype.gcda=f;var c=function(b,e,i,h){if("number"==typeof e)if(b<2)this.fromInt(1);else{this.fromNumber(b,i);!this.testBit(b-1)&&this.bitwiseTo(a.ONE.shiftLeft(b-1),A,this);this.isEven()&&this.dAddOffset(1,0);var c=this,f=function(){c.dAddOffset(2,0);c.bitLength()>b&&c.subTo(a.ONE.shiftLeft(b-1),c);if(c.isProbablePrime(e))setTimeout(function(){h()},0);else setTimeout(f,0)};setTimeout(f,0)}else{var d=[],g=b&7;d.length=(b>>3)+1;e.nextBytes(d);if(g>0)d[0]&=(1<<g)-1;else d[0]=0;this.fromString(d,256)}};a.prototype.fromNumberAsync=c})();var q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",L="=";function D(d){for(var b,c="",a=0;a+3<=d.length;a+=3){b=parseInt(d.substring(a,a+3),16);c+=q.charAt(b>>6)+q.charAt(b&63)}if(a+1==d.length){b=parseInt(d.substring(a,a+1),16);c+=q.charAt(b<<2)}else if(a+2==d.length){b=parseInt(d.substring(a,a+2),16);c+=q.charAt(b>>2)+q.charAt((b&3)<<4)}while((c.length&3)>0)c+=L;return c}function K(e){for(var a="",b=0,c,d=0;d<e.length;++d){if(e.charAt(d)==L)break;v=q.indexOf(e.charAt(d));if(v<0)continue;if(b==0){a+=j(v>>2);c=v&3;b=1}else if(b==1){a+=j(c<<2|v>>4);c=v&15;b=2}else if(b==2){a+=j(c);a+=j(v>>2);c=v&3;b=3}else{a+=j(c<<2|v>>4);a+=j(v&15);b=0}}if(b==1)a+=j(c<<2);return a}/* asn1-1.0.2.js (c) 2013 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
var c=c||{};c.env=c.env||{};var G=c,F=Object.prototype,W="[object Function]",Q=["toString","valueOf"];c.env.parseUA=function(h){var d=function(b){var a=0;return parseFloat(b.replace(/\./g,function(){return a++==1?"":"."}))},g=navigator,b={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:g&&g.cajaVersion,secure:false,os:null},c=h||navigator&&navigator.userAgent,f=window&&window.location,e=f&&f.href,a;b.secure=e&&e.toLowerCase().indexOf("https")===0;if(c){if(/windows|win32/i.test(c))b.os="windows";else if(/macintosh/i.test(c))b.os="macintosh";else if(/rhino/i.test(c))b.os="rhino";if(/KHTML/.test(c))b.webkit=1;a=c.match(/AppleWebKit\/([^\s]*)/);if(a&&a[1]){b.webkit=d(a[1]);if(/ Mobile\//.test(c)){b.mobile="Apple";a=c.match(/OS ([^\s]*)/);if(a&&a[1])a=d(a[1].replace("_","."));b.ios=a;b.ipad=b.ipod=b.iphone=0;a=c.match(/iPad|iPod|iPhone/);if(a&&a[0])b[a[0].toLowerCase()]=b.ios}else{a=c.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/);if(a)b.mobile=a[0];if(/webOS/.test(c)){b.mobile="WebOS";a=c.match(/webOS\/([^\s]*);/);if(a&&a[1])b.webos=d(a[1])}if(/ Android/.test(c)){b.mobile="Android";a=c.match(/Android ([^\s]*);/);if(a&&a[1])b.android=d(a[1])}}a=c.match(/Chrome\/([^\s]*)/);if(a&&a[1])b.chrome=d(a[1]);else{a=c.match(/AdobeAIR\/([^\s]*)/);if(a)b.air=a[0]}}if(!b.webkit){a=c.match(/Opera[\s\/]([^\s]*)/);if(a&&a[1]){b.opera=d(a[1]);a=c.match(/Version\/([^\s]*)/);if(a&&a[1])b.opera=d(a[1]);a=c.match(/Opera Mini[^;]*/);if(a)b.mobile=a[0]}else{a=c.match(/MSIE\s([^;]*)/);if(a&&a[1])b.ie=d(a[1]);else{a=c.match(/Gecko\/([^\s]*)/);if(a){b.gecko=1;a=c.match(/rv:([^\s\)]*)/);if(a&&a[1])b.gecko=d(a[1])}}}}}return b};c.env.ua=c.env.parseUA();c.isFunction=function(a){return typeof a==="function"||F.toString.apply(a)===W};c._IEEnumFix=c.env.ua.ie?function(d,e){for(var a,b,c=0;c<Q.length;c=c+1){a=Q[c];b=e[a];if(G.isFunction(b)&&b!=F[a])d[a]=b}}:function(){};c.extend=function(a,b,c){if(!b||!a)throw new Error("extend failed, please check that all dependencies are included.");var e=function(){},d;e.prototype=b.prototype;a.prototype=new e;a.prototype.constructor=a;a.superclass=b.prototype;if(b.prototype.constructor==F.constructor)b.prototype.constructor=b;if(c){for(d in c)if(G.hasOwnProperty(c,d))a.prototype[d]=c[d];G._IEEnumFix(a.prototype,c)}};if(typeof KJUR=="undefined"||!KJUR)KJUR={};if(typeof KJUR.asn1=="undefined"||!KJUR.asn1)KJUR.asn1={};KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(b){var a=b.toString(16);if(a.length%2==1)a="0"+a;return a};this.bigIntToMinTwosComplementsHex=function(d){var b=d.toString(16);if(b.substr(0,1)!="-"){if(b.length%2==1)b="0"+b;else if(!b.match(/^[0-7]/))b="00"+b}else{var i=b.substr(1),c=i.length;if(c%2==1)c+=1;else if(!b.match(/^[0-7]/))c+=2;for(var e="",f=0;f<c;f++)e+="f";var g=new a(e,16),h=g.xor(d).add(a.ONE);b=h.toString(16).replace(/^-/,"")}return b};this.getPEMStringFromHex=function(d,b){var e=CryptoJS.enc.Hex.parse(d),c=CryptoJS.enc.Base64.stringify(e),a=c.replace(/(.{64})/g,"$1\r\n");a=a.replace(/\r\n$/,"");return"-----BEGIN "+b+"-----\r\n"+a+"\r\n-----END "+b+"-----\r\n"}};KJUR.asn1.ASN1Object=function(){var b=true,c=null,e="00",d="00",a="";this.getLengthHexFromValue=function(){if(typeof this.hV=="undefined"||this.hV==null)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+a.length+",v="+this.hV;var c=this.hV.length/2,b=c.toString(16);if(b.length%2==1)b="0"+b;if(c<128)return b;else{var d=b.length/2;if(d>15)throw"ASN.1 length too long to represent by 8x: n = "+c.toString(16);var e=128+d;return e.toString(16)+b}};this.getEncodedHex=function(){if(this.hTLV==null||this.isModified){this.hV=this.getFreshValueHex();this.hL=this.getLengthHexFromValue();this.hTLV=this.hT+this.hL+this.hV;this.isModified=false}return this.hTLV};this.getValueHex=function(){this.getEncodedHex();return this.hV};this.getFreshValueHex=function(){return""}};KJUR.asn1.DERAbstractString=function(a){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);var c=null,b=null;this.getString=function(){return this.s};this.setString=function(a){this.hTLV=null;this.isModified=true;this.s=a;this.hV=stohex(this.s)};this.setStringHex=function(a){this.hTLV=null;this.isModified=true;this.s=null;this.hV=a};this.getFreshValueHex=function(){return this.hV};if(typeof a!="undefined")if(typeof a.str!="undefined")this.setString(a.str);else typeof a.hex!="undefined"&&this.setStringHex(a.hex)};c.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object);KJUR.asn1.DERAbstractTime=function(){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);var c=null,b=null;this.localDateToUTC=function(a){utc=a.getTime()+a.getTimezoneOffset()*6e4;var b=new Date(utc);return b};this.formatDate=function(d,g){var b=this.zeroPadding,a=this.localDateToUTC(d),c=String(a.getFullYear());if(g=="utc")c=c.substr(2,2);var e=b(String(a.getMonth()+1),2),h=b(String(a.getDate()),2),f=b(String(a.getHours()),2),i=b(String(a.getMinutes()),2),j=b(String(a.getSeconds()),2);return c+e+h+f+i+j+"Z"};this.zeroPadding=function(a,b){return a.length>=b?a:(new Array(b-a.length+1)).join("0")+a};this.getString=function(){return this.s};this.setString=function(a){this.hTLV=null;this.isModified=true;this.s=a;this.hV=stohex(this.s)};this.setByDateValue=function(d,b,e,c,f,g){var a=new Date(Date.UTC(d,b-1,e,c,f,g,0));this.setByDate(a)};this.getFreshValueHex=function(){return this.hV}};c.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object);KJUR.asn1.DERAbstractStructured=function(a){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);var b=null;this.setByASN1ObjectArray=function(a){this.hTLV=null;this.isModified=true;this.asn1Array=a};this.appendASN1Object=function(a){this.hTLV=null;this.isModified=true;this.asn1Array.push(a)};this.asn1Array=[];if(typeof a!="undefined")if(typeof a.array!="undefined")this.asn1Array=a.array};c.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object);KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this);this.hT="01";this.hTLV="0101ff"};c.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object);KJUR.asn1.DERInteger=function(b){KJUR.asn1.DERInteger.superclass.constructor.call(this);this.hT="02";this.setByBigInteger=function(a){this.hTLV=null;this.isModified=true;this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(a)};this.setByInteger=function(b){var c=new a(String(b),10);this.setByBigInteger(c)};this.setValueHex=function(a){this.hV=a};this.getFreshValueHex=function(){return this.hV};if(typeof b!="undefined")if(typeof b.bigint!="undefined")this.setByBigInteger(b.bigint);else if(typeof b["int"]!="undefined")this.setByInteger(b["int"]);else typeof b.hex!="undefined"&&this.setValueHex(b.hex)};c.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object);KJUR.asn1.DERBitString=function(a){KJUR.asn1.DERBitString.superclass.constructor.call(this);this.hT="03";this.setHexValueIncludingUnusedBits=function(a){this.hTLV=null;this.isModified=true;this.hV=a};this.setUnusedBitsAndHexValue=function(a,c){if(a<0||7<a)throw"unused bits shall be from 0 to 7: u = "+a;var b="0"+a;this.hTLV=null;this.isModified=true;this.hV=b+c};this.setByBinaryString=function(a){a=a.replace(/0+$/,"");var c=8-a.length%8;if(c==8)c=0;for(var b=0;b<=c;b++)a+="0";for(var e="",b=0;b<a.length-1;b+=8){var f=a.substr(b,8),d=parseInt(f,2).toString(16);if(d.length==1)d="0"+d;e+=d}this.hTLV=null;this.isModified=true;this.hV="0"+c+e};this.setByBooleanArray=function(c){for(var b="",a=0;a<c.length;a++)if(c[a]==true)b+="1";else b+="0";this.setByBinaryString(b)};this.newFalseArray=function(b){for(var c=new Array(b),a=0;a<b;a++)c[a]=false;return c};this.getFreshValueHex=function(){return this.hV};if(typeof a!="undefined")if(typeof a.hex!="undefined")this.setHexValueIncludingUnusedBits(a.hex);else if(typeof a.bin!="undefined")this.setByBinaryString(a.bin);else typeof a.array!="undefined"&&this.setByBooleanArray(a.array)};c.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object);KJUR.asn1.DEROctetString=function(a){KJUR.asn1.DEROctetString.superclass.constructor.call(this,a);this.hT="04"};c.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this);this.hT="05";this.hTLV="0500"};c.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object);KJUR.asn1.DERObjectIdentifier=function(b){var c=function(b){var a=b.toString(16);if(a.length==1)a="0"+a;return a},d=function(i){var h="",j=new a(i,10),b=j.toString(2),e=7-b.length%7;if(e==7)e=0;for(var g="",d=0;d<e;d++)g+="0";b=g+b;for(var d=0;d<b.length-1;d+=7){var f=b.substr(d,7);if(d!=b.length-7)f="1"+f;h+=c(parseInt(f,2))}return h};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this);this.hT="06";this.setValueHex=function(a){this.hTLV=null;this.isModified=true;this.s=null;this.hV=a};this.setValueOidString=function(b){if(!b.match(/^[0-9.]+$/))throw"malformed oid string: "+b;var e="",a=b.split("."),g=parseInt(a[0])*40+parseInt(a[1]);e+=c(g);a.splice(0,2);for(var f=0;f<a.length;f++)e+=d(a[f]);this.hTLV=null;this.isModified=true;this.s=null;this.hV=e};this.setValueName=function(a){if(typeof KJUR.asn1.x509.OID.name2oidList[a]!="undefined"){var b=KJUR.asn1.x509.OID.name2oidList[a];this.setValueOidString(b)}else throw"DERObjectIdentifier oidName undefined: "+a;};this.getFreshValueHex=function(){return this.hV};if(typeof b!="undefined")if(typeof b.oid!="undefined")this.setValueOidString(b.oid);else if(typeof b.hex!="undefined")this.setValueHex(b.hex);else typeof b.name!="undefined"&&this.setValueName(b.name)};c.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object);KJUR.asn1.DERUTF8String=function(a){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,a);this.hT="0c"};c.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString);KJUR.asn1.DERNumericString=function(a){KJUR.asn1.DERNumericString.superclass.constructor.call(this,a);this.hT="12"};c.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERPrintableString=function(a){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,a);this.hT="13"};c.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERTeletexString=function(a){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,a);this.hT="14"};c.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERIA5String=function(a){KJUR.asn1.DERIA5String.superclass.constructor.call(this,a);this.hT="16"};c.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString);KJUR.asn1.DERUTCTime=function(a){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,a);this.hT="17";this.setByDate=function(a){this.hTLV=null;this.isModified=true;this.date=a;this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)};if(typeof a!="undefined")if(typeof a.str!="undefined")this.setString(a.str);else if(typeof a.hex!="undefined")this.setStringHex(a.hex);else typeof a.date!="undefined"&&this.setByDate(a.date)};c.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime);KJUR.asn1.DERGeneralizedTime=function(a){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,a);this.hT="18";this.setByDate=function(a){this.hTLV=null;this.isModified=true;this.date=a;this.s=this.formatDate(this.date,"gen");this.hV=stohex(this.s)};if(typeof a!="undefined")if(typeof a.str!="undefined")this.setString(a.str);else if(typeof a.hex!="undefined")this.setStringHex(a.hex);else typeof a.date!="undefined"&&this.setByDate(a.date)};c.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime);KJUR.asn1.DERSequence=function(a){KJUR.asn1.DERSequence.superclass.constructor.call(this,a);this.hT="30";this.getFreshValueHex=function(){for(var b="",a=0;a<this.asn1Array.length;a++){var c=this.asn1Array[a];b+=c.getEncodedHex()}this.hV=b;return this.hV}};c.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured);KJUR.asn1.DERSet=function(a){KJUR.asn1.DERSet.superclass.constructor.call(this,a);this.hT="31";this.getFreshValueHex=function(){for(var a=[],b=0;b<this.asn1Array.length;b++){var c=this.asn1Array[b];a.push(c.getEncodedHex())}a.sort();this.hV=a.join("");return this.hV}};c.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured);KJUR.asn1.DERTaggedObject=function(a){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this);this.hT="a0";this.hV="";this.isExplicit=true;this.asn1Object=null;this.setASN1Object=function(c,b,a){this.hT=b;this.isExplicit=c;this.asn1Object=a;if(this.isExplicit){this.hV=this.asn1Object.getEncodedHex();this.hTLV=null;this.isModified=true}else{this.hV=null;this.hTLV=a.getEncodedHex();this.hTLV=this.hTLV.replace(/^../,b);this.isModified=false}};this.getFreshValueHex=function(){return this.hV};if(typeof a!="undefined"){if(typeof a.tag!="undefined")this.hT=a.tag;if(typeof a.explicit!="undefined")this.isExplicit=a.explicit;if(typeof a.obj!="undefined"){this.asn1Object=a.obj;this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)}}};c.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object);(function(b){"use strict";var c={},a;c.decode=function(j){var c;if(a===b){var f="0123456789ABCDEF",i=" \f\n\r\t\u00a0\u2028\u2029";a=[];for(c=0;c<16;++c)a[f.charAt(c)]=c;f=f.toLowerCase();for(c=10;c<16;++c)a[f.charAt(c)]=c;for(c=0;c<i.length;++c)a[i.charAt(c)]=-1}var h=[],e=0,g=0;for(c=0;c<j.length;++c){var d=j.charAt(c);if(d=="=")break;d=a[d];if(d==-1)continue;if(d===b)throw"Illegal character at offset "+c;e|=d;if(++g>=2){h[h.length]=e;e=0;g=0}else e<<=4}if(g)throw"Hex encoding incomplete: 4 bits missing";return h};window.Hex=c})();(function(c){"use strict";var a={},b;a.decode=function(i){var a;if(b===c){var j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="= \f\n\r\t\u00a0\u2028\u2029";b=[];for(a=0;a<64;++a)b[j.charAt(a)]=a;for(a=0;a<h.length;++a)b[h.charAt(a)]=-1}var d=[],e=0,g=0;for(a=0;a<i.length;++a){var f=i.charAt(a);if(f=="=")break;f=b[f];if(f==-1)continue;if(f===c)throw"Illegal character at offset "+a;e|=f;if(++g>=4){d[d.length]=e>>16;d[d.length]=e>>8&255;d[d.length]=e&255;e=0;g=0}else e<<=6}switch(g){case 1:throw"Base64 encoding incomplete: at least 2 bits missing";case 2:d[d.length]=e>>10;break;case 3:d[d.length]=e>>16;d[d.length]=e>>8&255}return d};a.re=/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/;a.unarmor=function(c){var b=a.re.exec(c);if(b)if(b[1])c=b[1];else if(b[2])c=b[2];else throw"RegExp out of sync";return a.decode(c)};window.Base64=a})();(function(e){"use strict";var d=100,f="\u2026",c={tag:function(c,b){var a=document.createElement(c);a.className=b;return a},text:function(a){return document.createTextNode(a)}};function b(a,c){if(a instanceof b){this.enc=a.enc;this.pos=a.pos}else{this.enc=a;this.pos=c}}b.prototype.get=function(a){if(a===e)a=this.pos++;if(a>=this.enc.length)throw"Requesting byte offset "+a+" on a stream of length "+this.enc.length;return this.enc[a]};b.prototype.hexDigits="0123456789ABCDEF";b.prototype.hexByte=function(a){return this.hexDigits.charAt(a>>4&15)+this.hexDigits.charAt(a&15)};b.prototype.hexDump=function(c,d,e){for(var a="",b=c;b<d;++b){a+=this.hexByte(this.get(b));if(e!==true)switch(b&15){case 7:a+="  ";break;case 15:a+="\n";break;default:a+=" "}}return a};b.prototype.parseStringISO=function(c,d){for(var b="",a=c;a<d;++a)b+=String.fromCharCode(this.get(a));return b};b.prototype.parseStringUTF=function(d,e){for(var c="",b=d;b<e;){var a=this.get(b++);if(a<128)c+=String.fromCharCode(a);else if(a>191&&a<224)c+=String.fromCharCode((a&31)<<6|this.get(b++)&63);else c+=String.fromCharCode((a&15)<<12|(this.get(b++)&63)<<6|this.get(b++)&63)}return c};b.prototype.parseStringBMP=function(e,f){for(var b="",a=e;a<f;a+=2){var c=this.get(a),d=this.get(a+1);b+=String.fromCharCode((c<<8)+d)}return b};b.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;b.prototype.parseTime=function(c,d){var b=this.parseStringISO(c,d),a=this.reTime.exec(b);if(!a)return"Unrecognized time: "+b;b=a[1]+"-"+a[2]+"-"+a[3]+" "+a[4];if(a[5]){b+=":"+a[5];if(a[6]){b+=":"+a[6];if(a[7])b+="."+a[7]}}if(a[8]){b+=" UTC";if(a[8]!="Z"){b+=a[8];if(a[9])b+=":"+a[9]}}return b};b.prototype.parseInteger=function(b,f){var a=f-b;if(a>4){a<<=3;var e=this.get(b);if(e===0)a-=8;else while(e<128){e<<=1;--a}return"("+a+" bit)"}for(var d=0,c=b;c<f;++c)d=d<<8|this.get(c);return d};b.prototype.parseBitString=function(a,h){var e=this.get(a),f=(h-a-1<<3)-e,d="("+f+" bit)";if(f<=20){var g=e;d+=" ";for(var b=h-1;b>a;--b){for(var i=this.get(b),c=g;c<8;++c)d+=i>>c&1?"1":"0";g=0}}return d};b.prototype.parseOctetString=function(a,b){var c=b-a,g="("+c+" byte) ";if(c>d)b=a+d;for(var e=a;e<b;++e)g+=this.hexByte(this.get(e));if(c>d)g+=f;return g};b.prototype.parseOID=function(g,h){for(var b="",a=0,c=0,d=g;d<h;++d){var f=this.get(d);a=a<<7|f&127;c+=7;if(!(f&128)){if(b===""){var e=a<80?a<40?0:1:2;b=e+"."+(a-e*40)}else b+="."+(c>=31?"bigint":a);a=c=0}}return b};function a(c,a,b,e,d){this.stream=c;this.header=a;this.length=b;this.tag=e;this.sub=d}a.prototype.typeName=function(){if(this.tag===e)return"unknown";var b=this.tag>>6,c=this.tag>>5&1,a=this.tag&31;switch(b){case 0:switch(a){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+a.toString(16)}case 1:return"Application_"+a.toString(16);case 2:return"["+a+"]";case 3:return"Private_"+a.toString(16)}};a.prototype.reSeemsASCII=/^[ -~]+$/;a.prototype.content=function(){if(this.tag===e)return null;var h=this.tag>>6,g=this.tag&31,a=this.posContent(),b=Math.abs(this.length);if(h!==0){if(this.sub!==null)return"("+this.sub.length+" elem)";var c=this.stream.parseStringISO(a,a+Math.min(b,d));return this.reSeemsASCII.test(c)?c.substring(0,2*d)+(c.length>2*d?f:""):this.stream.parseOctetString(a,a+b)}switch(g){case 1:return this.stream.get(a)===0?"false":"true";case 2:return this.stream.parseInteger(a,a+b);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(a,a+b);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(a,a+b);case 6:return this.stream.parseOID(a,a+b);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return this.stream.parseStringUTF(a,a+b);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(a,a+b);case 30:return this.stream.parseStringBMP(a,a+b);case 23:case 24:return this.stream.parseTime(a,a+b)}return null};a.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(this.sub===null?"null":this.sub.length)+"]"};a.prototype.print=function(a){if(a===e)a="";document.writeln(a+this);if(this.sub!==null){a+="  ";for(var b=0,c=this.sub.length;b<c;++b)this.sub[b].print(a)}};a.prototype.toPrettyString=function(b){if(b===e)b="";var a=b+this.typeName()+" @"+this.stream.pos;if(this.length>=0)a+="+";a+=this.length;if(this.tag&32)a+=" (constructed)";else if((this.tag==3||this.tag==4)&&this.sub!==null)a+=" (encapsulates)";a+="\n";if(this.sub!==null){b+="  ";for(var c=0,d=this.sub.length;c<d;++c)a+=this.sub[c].toPrettyString(b)}return a};a.prototype.toDOM=function(){var b=c.tag("div","node");b.asn1=this;var f=c.tag("div","head"),a=this.typeName().replace(/_/g," ");f.innerHTML=a;var d=this.content();if(d!==null){d=String(d).replace(/</g,"&lt;");var h=c.tag("span","preview");h.appendChild(c.text(d));f.appendChild(h)}b.appendChild(f);this.node=b;this.head=f;var i=c.tag("div","value");a="Offset: "+this.stream.pos+"<br/>";a+="Length: "+this.header+"+";if(this.length>=0)a+=this.length;else a+=-this.length+" (undefined)";if(this.tag&32)a+="<br/>(constructed)";else if((this.tag==3||this.tag==4)&&this.sub!==null)a+="<br/>(encapsulates)";if(d!==null){a+="<br/>Value:<br/><b>"+d+"</b>";if(typeof oids==="object"&&this.tag==6){var e=oids[d];if(e){if(e.d)a+="<br/>"+e.d;if(e.c)a+="<br/>"+e.c;if(e.w)a+="<br/>(warning!)"}}}i.innerHTML=a;b.appendChild(i);var j=c.tag("div","sub");if(this.sub!==null)for(var g=0,k=this.sub.length;g<k;++g)j.appendChild(this.sub[g].toDOM());b.appendChild(j);f.onclick=function(){b.className=b.className=="node collapsed"?"node":"node collapsed"};return b};a.prototype.posStart=function(){return this.stream.pos};a.prototype.posContent=function(){return this.stream.pos+this.header};a.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)};a.prototype.fakeHover=function(a){this.node.className+=" hover";if(a)this.head.className+=" hover"};a.prototype.fakeOut=function(b){var a=/ ?hover/;this.node.className=this.node.className.replace(a,"");if(b)this.head.className=this.head.className.replace(a,"")};a.prototype.toHexDOM_sub=function(g,e,f,a,b){if(a>=b)return;var d=c.tag("span",e);d.appendChild(c.text(f.hexDump(a,b)));g.appendChild(d)};a.prototype.toHexDOM=function(b){var a=c.tag("span","hex");if(b===e)b=a;this.head.hexNode=a;this.head.onmouseover=function(){this.hexNode.className="hexCurrent"};this.head.onmouseout=function(){this.hexNode.className="hex"};a.asn1=this;a.onmouseover=function(){var a=!b.selected;if(a){b.selected=this.asn1;this.className="hexCurrent"}this.asn1.fakeHover(a)};a.onmouseout=function(){var a=b.selected==this.asn1;this.asn1.fakeOut(a);if(a){b.selected=null;this.className="hex"}};this.toHexDOM_sub(a,"tag",this.stream,this.posStart(),this.posStart()+1);this.toHexDOM_sub(a,this.length>=0?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent());if(this.sub===null)a.appendChild(c.text(this.stream.hexDump(this.posContent(),this.posEnd())));else if(this.sub.length>0){var f=this.sub[0],g=this.sub[this.sub.length-1];this.toHexDOM_sub(a,"intro",this.stream,this.posContent(),f.posStart());for(var d=0,h=this.sub.length;d<h;++d)a.appendChild(this.sub[d].toHexDOM(b));this.toHexDOM_sub(a,"outro",this.stream,g.posEnd(),this.posEnd())}return a};a.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),true)};a.decodeLength=function(c){var a=c.get(),b=a&127;if(b==a)return b;if(b>3)throw"Length over 24 bits not supported at position "+(c.pos-1);if(b===0)return-1;a=0;for(var d=0;d<b;++d)a=a<<8|c.get();return a};a.hasContent=function(c,h,e){if(c&32)return true;if(c<3||c>4)return false;var d=new b(e);c==3&&d.get();var g=d.get();if(g>>6&1)return false;try{var f=a.decodeLength(d);return d.pos-e.pos+f==h}catch(i){return false}};a.decode=function(c){if(!(c instanceof b))c=new b(c,0);var h=new b(c),g=c.get(),d=a.decodeLength(c),k=c.pos-h.pos,e=null;if(a.hasContent(g,d,c)){var f=c.pos;g==3&&c.get();e=[];if(d>=0){var i=f+d;while(c.pos<i)e[e.length]=a.decode(c);if(c.pos!=i)throw"Content size is not correct for container starting at offset "+f;}else try{for(;true;){var j=a.decode(c);if(j.tag===0)break;e[e.length]=j}d=f-c.pos}catch(l){throw"Exception while decoding undefined length content: "+l;}}else c.pos+=d;return new a(h,k,d,g,e)};a.test=function(){for(var d=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650}],c=0,g=d.length;c<g;++c){var h=0,f=new b(d[c].value,0),e=a.decodeLength(f);e!=d[c].expected&&document.write("In test["+c+"] expected "+d[c].expected+" got "+e+"\n")}};window.ASN1=a})();ASN1.prototype.getHexStringValue=function(){var a=this.toHexString(),c=this.header*2,b=this.length*2;return a.substr(c,b)};d.prototype.parseKey=function(d){try{var c=0,b=0,n=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,o=n.test(d)?Hex.decode(d):Base64.unarmor(d),a=ASN1.decode(o);if(a.sub.length===3)a=a.sub[2].sub[0];if(a.sub.length===9){c=a.sub[1].getHexStringValue();this.n=e(c,16);b=a.sub[2].getHexStringValue();this.e=parseInt(b,16);var g=a.sub[3].getHexStringValue();this.d=e(g,16);var l=a.sub[4].getHexStringValue();this.p=e(l,16);var m=a.sub[5].getHexStringValue();this.q=e(m,16);var j=a.sub[6].getHexStringValue();this.dmp1=e(j,16);var k=a.sub[7].getHexStringValue();this.dmq1=e(k,16);var h=a.sub[8].getHexStringValue();this.coeff=e(h,16)}else if(a.sub.length===2){var i=a.sub[1],f=i.sub[0];c=f.sub[0].getHexStringValue();this.n=e(c,16);b=f.sub[1].getHexStringValue();this.e=parseInt(b,16)}else return false;return true}catch(p){return false}};d.prototype.getPrivateBaseKey=function(){var a={array:[new KJUR.asn1.DERInteger({"int":0}),new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({"int":this.e}),new KJUR.asn1.DERInteger({bigint:this.d}),new KJUR.asn1.DERInteger({bigint:this.p}),new KJUR.asn1.DERInteger({bigint:this.q}),new KJUR.asn1.DERInteger({bigint:this.dmp1}),new KJUR.asn1.DERInteger({bigint:this.dmq1}),new KJUR.asn1.DERInteger({bigint:this.coeff})]},b=new KJUR.asn1.DERSequence(a);return b.getEncodedHex()};d.prototype.getPrivateBaseKeyB64=function(){return D(this.getPrivateBaseKey())};d.prototype.getPublicBaseKey=function(){var a={array:[new KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new KJUR.asn1.DERNull]},c=new KJUR.asn1.DERSequence(a);a={array:[new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({"int":this.e})]};var b=new KJUR.asn1.DERSequence(a);a={hex:"00"+b.getEncodedHex()};var d=new KJUR.asn1.DERBitString(a);a={array:[c,d]};var e=new KJUR.asn1.DERSequence(a);return e.getEncodedHex()};d.prototype.getPublicBaseKeyB64=function(){return D(this.getPublicBaseKey())};d.prototype.wordwrap=function(b,a){a=a||64;if(!b)return b;var c="(.{1,"+a+"})( +|$\n?)|(.{1,"+a+"})";return b.match(RegExp(c,"g")).join("\n")};d.prototype.getPrivateKey=function(){var a="-----BEGIN RSA PRIVATE KEY-----\n";a+=this.wordwrap(this.getPrivateBaseKeyB64())+"\n";a+="-----END RSA PRIVATE KEY-----";return a};d.prototype.getPublicKey=function(){var a="-----BEGIN PUBLIC KEY-----\n";a+=this.wordwrap(this.getPublicBaseKeyB64())+"\n";a+="-----END PUBLIC KEY-----";return a};d.prototype.hasPublicKeyProperty=function(a){a=a||{};return a.hasOwnProperty("n")&&a.hasOwnProperty("e")};d.prototype.hasPrivateKeyProperty=function(a){a=a||{};return a.hasOwnProperty("n")&&a.hasOwnProperty("e")&&a.hasOwnProperty("d")&&a.hasOwnProperty("p")&&a.hasOwnProperty("q")&&a.hasOwnProperty("dmp1")&&a.hasOwnProperty("dmq1")&&a.hasOwnProperty("coeff")};d.prototype.parsePropertiesFrom=function(a){this.n=a.n;this.e=a.e;if(a.hasOwnProperty("d")){this.d=a.d;this.p=a.p;this.q=a.q;this.dmp1=a.dmp1;this.dmq1=a.dmq1;this.coeff=a.coeff}};var s=function(a){d.call(this);if(a)if(typeof a==="string")this.parseKey(a);else(this.hasPrivateKeyProperty(a)||this.hasPublicKeyProperty(a))&&this.parsePropertiesFrom(a)};s.prototype=new d;s.prototype.constructor=s;var g=function(a){a=a||{};this.default_key_size=parseInt(a.default_key_size)||1024;this.default_public_exponent=a.default_public_exponent||"010001";this.log=a.log||false;this.key=null};g.prototype.setKey=function(a){this.log&&this.key&&console.warn("A key was already set, overriding existing.");this.key=new s(a)};g.prototype.setPrivateKey=function(a){this.setKey(a)};g.prototype.setPublicKey=function(a){this.setKey(a)};g.prototype.decrypt=function(a){try{return this.getKey().decrypt(K(a))}catch(b){return false}};g.prototype.encrypt=function(a){try{return D(this.getKey().encrypt(a))}catch(b){return false}};g.prototype.getKey=function(a){if(!this.key){this.key=new s;if(a&&{}.toString.call(a)==="[object Function]"){this.key.generateAsync(this.default_key_size,this.default_public_exponent,a);return}this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key};g.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()};g.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()};g.prototype.getPublicKey=function(){return this.getKey().getPublicKey()};g.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()};g.version="2.3.1";zc.JSEncrypt=g});var CryptoJS=CryptoJS||function(c,i){var e={},d=e.lib={},b=d.Base=function(){function a(){}return{extend:function(c){a.prototype=this;var b=new a;c&&b.mixIn(c);if(!b.hasOwnProperty("init"))b.init=function(){b.$super.init.apply(this,arguments)};b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)if(a.hasOwnProperty(b))this[b]=a[b];if(a.hasOwnProperty("toString"))this.toString=a.toString},clone:function(){return this.init.prototype.extend(this)}}}(),a=d.WordArray=b.extend({init:function(a,b){a=this.words=a||[];if(b!=i)this.sigBytes=b;else this.sigBytes=a.length*4},toString:function(a){return(a||l).stringify(this)},concat:function(f){var d=this.words,c=f.words,b=this.sigBytes,e=f.sigBytes;this.clamp();if(b%4)for(var a=0;a<e;a++){var g=c[a>>>2]>>>24-a%4*8&255;d[b+a>>>2]|=g<<24-(b+a)%4*8}else if(c.length>65535)for(var a=0;a<e;a+=4)d[b+a>>>2]=c[a>>>2];else d.push.apply(d,c);this.sigBytes+=e;return this},clamp:function(){var b=this.words,a=this.sigBytes;b[a>>>2]&=4294967295<<32-a%4*8;b.length=c.ceil(a/4)},clone:function(){var a=b.clone.call(this);a.words=this.words.slice(0);return a},random:function(b){for(var d=[],e=0;e<b;e+=4)d.push(c.random()*4294967296|0);return new a.init(d,b)}}),f=e.enc={},l=f.Hex={stringify:function(c){for(var f=c.words,e=c.sigBytes,b=[],a=0;a<e;a++){var d=f[a>>>2]>>>24-a%4*8&255;b.push((d>>>4).toString(16));b.push((d&15).toString(16))}return b.join("")},parse:function(d){for(var c=d.length,e=[],b=0;b<c;b+=2)e[b>>>3]|=parseInt(d.substr(b,2),16)<<24-b%8*4;return new a.init(e,c/2)}},h=f.Latin1={stringify:function(c){for(var e=c.words,d=c.sigBytes,b=[],a=0;a<d;a++){var f=e[a>>>2]>>>24-a%4*8&255;b.push(String.fromCharCode(f))}return b.join("")},parse:function(d){for(var c=d.length,e=[],b=0;b<c;b++)e[b>>>2]|=(d.charCodeAt(b)&255)<<24-b%4*8;return new a.init(e,c)}},k=f.Utf8={stringify:function(a){try{return decodeURIComponent(escape(h.stringify(a)))}catch(b){throw new Error("Malformed UTF-8 data");}},parse:function(a){return h.parse(unescape(encodeURIComponent(a)))}},g=d.BufferedBlockAlgorithm=b.extend({reset:function(){this._data=new a.init;this._nDataBytes=0},_append:function(a){if(typeof a=="string")a=k.parse(a);this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(m){var g=this._data,j=g.words,h=g.sigBytes,e=this.blockSize,k=e*4,b=h/k;if(m)b=c.ceil(b);else b=c.max((b|0)-this._minBufferSize,0);var d=b*e,i=c.min(d*4,h);if(d){for(var f=0;f<d;f+=e)this._doProcessBlock(j,f);var l=j.splice(0,d);g.sigBytes-=i}return new a.init(l,i)},clone:function(){var a=b.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0}),m=d.Hasher=g.extend({cfg:b.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){g.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);var b=this._doFinalize();return b},blockSize:512/32,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return(new j.HMAC.init(a,c)).finalize(b)}}}),j=e.algo={};return e}(Math);CryptoJS.lib.Cipher||function(o){var b=CryptoJS,a=b.lib,e=a.Base,d=a.WordArray,h=a.BufferedBlockAlgorithm,j=b.enc,z=j.Utf8,i=j.Base64,q=b.algo,s=q.EvpKDF,f=a.Cipher=h.extend({cfg:e.extend(),createEncryptor:function(b,a){return this.create(this._ENC_XFORM_MODE,b,a)},createDecryptor:function(b,a){return this.create(this._DEC_XFORM_MODE,b,a)},init:function(a,c,b){this.cfg=this.cfg.extend(b);this._xformMode=a;this._key=c;this.reset()},reset:function(){h.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);var b=this._doFinalize();return b},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function a(a){return typeof a=="string"?k:c}return function(b){return{encrypt:function(d,c,e){return a(c).encrypt(b,d,c,e)},decrypt:function(d,c,e){return a(c).decrypt(b,d,c,e)}}}}()}),x=a.StreamCipher=f.extend({_doFinalize:function(){return this._process(!!"flush")},blockSize:1}),r=b.mode={},m=a.BlockCipherMode=e.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}}),w=r.CBC=function(){var a=m.extend();a.Encryptor=a.extend({processBlock:function(c,a){var e=this._cipher,d=e.blockSize;b.call(this,c,a,d);e.encryptBlock(c,a);this._prevBlock=c.slice(a,a+d)}});a.Decryptor=a.extend({processBlock:function(c,a){var e=this._cipher,d=e.blockSize,f=c.slice(a,a+d);e.decryptBlock(c,a);b.call(this,c,a,d);this._prevBlock=f}});function b(f,d,c){var b=this._iv;if(b){var e=b;this._iv=o}else var e=this._prevBlock;for(var a=0;a<c;a++)f[d+a]^=e[a]}return a}(),u=b.pad={},v=u.Pkcs7={pad:function(e,h){for(var b=h*4,a=b-e.sigBytes%b,g=a<<24|a<<16|a<<8|a,c=[],f=0;f<a;f+=4)c.push(g);var i=d.create(c,a);e.concat(i)},unpad:function(a){var b=a.words[a.sigBytes-1>>>2]&255;a.sigBytes-=b}},y=a.BlockCipher=f.extend({cfg:f.cfg.extend({mode:w,padding:v}),reset:function(){f.reset.call(this);var b=this.cfg,c=b.iv,a=b.mode;if(this._xformMode==this._ENC_XFORM_MODE)var d=a.createEncryptor;else{var d=a.createDecryptor;this._minBufferSize=1}this._mode=d.call(a,this,c&&c.words)},_doProcessBlock:function(b,a){this._mode.processBlock(b,a)},_doFinalize:function(){var b=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){b.pad(this._data,this.blockSize);var a=this._process(!!"flush")}else{var a=this._process(!!"flush");b.unpad(a)}return a},blockSize:128/32}),g=a.CipherParams=e.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),p=b.format={},l=p.OpenSSL={stringify:function(a){var b=a.ciphertext,c=a.salt;if(c)var e=d.create([1398893684,1701076831]).concat(c).concat(b);else var e=b;return e.toString(i)},parse:function(c){var b=i.parse(c),a=b.words;if(a[0]==1398893684&&a[1]==1701076831){var e=d.create(a.slice(2,4));a.splice(0,4);b.sigBytes-=16}return g.create({ciphertext:b,salt:e})}},c=a.SerializableCipher=e.extend({cfg:e.extend({format:l}),encrypt:function(c,h,e,a){a=this.cfg.extend(a);var d=c.createEncryptor(e,a),f=d.finalize(h),b=d.cfg;return g.create({ciphertext:f,key:e,iv:b.iv,algorithm:c,mode:b.mode,padding:b.padding,blockSize:c.blockSize,formatter:a.format})},decrypt:function(d,b,e,a){a=this.cfg.extend(a);b=this._parse(b,a.format);var c=d.createDecryptor(e,a).finalize(b.ciphertext);return c},_parse:function(a,b){return typeof a=="string"?b.parse(a,this):a}}),t=b.kdf={},n=t.OpenSSL={execute:function(f,b,e,a){if(!a)a=d.random(64/8);var c=s.create({keySize:b+e}).compute(f,a),h=d.create(c.words.slice(b),e*4);c.sigBytes=b*4;return g.create({key:c,iv:h,salt:a})}},k=a.PasswordBasedCipher=c.extend({cfg:c.cfg.extend({kdf:n}),encrypt:function(d,g,f,a){a=this.cfg.extend(a);var b=a.kdf.execute(f,d.keySize,d.ivSize);a.iv=b.iv;var e=c.encrypt.call(this,d,g,b.key,a);e.mixIn(b);return e},decrypt:function(d,b,g,a){a=this.cfg.extend(a);b=this._parse(b,a.format);var e=a.kdf.execute(g,d.keySize,d.ivSize,b.salt);a.iv=e.iv;var f=c.decrypt.call(this,d,b,e.key,a);return f}})}();(function(){var e=CryptoJS,h=e.lib,f=h.WordArray,b=h.BlockCipher,g=e.algo,n=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],i=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],j=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],m=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],k=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=g.DES=b.extend({_doReset:function(){for(var l=this._key,k=l.words,d=[],a=0;a<56;a++){var e=n[a]-1;d[a]=k[e>>>5]>>>31-e%32&1}for(var g=this._subKeys=[],c=0;c<16;c++){for(var b=g[c]=[],f=j[c],a=0;a<24;a++){b[a/6|0]|=d[(i[a]-1+f)%28]<<31-a%6;b[4+(a/6|0)]|=d[28+(i[a+24]-1+f)%28]<<31-a%6}b[0]=b[0]<<1|b[0]>>>31;for(var a=1;a<7;a++)b[a]=b[a]>>>(a-1)*4+3;b[7]=b[7]<<5|b[7]>>>27}for(var h=this._invSubKeys=[],a=0;a<16;a++)h[a]=g[15-a]},encryptBlock:function(b,a){this._doCryptBlock(b,a,this._subKeys)},decryptBlock:function(b,a){this._doCryptBlock(b,a,this._invSubKeys)},_doCryptBlock:function(e,d,i){this._lBlock=e[d];this._rBlock=e[d+1];a.call(this,4,252645135);a.call(this,16,65535);c.call(this,2,858993459);c.call(this,8,16711935);a.call(this,1,1431655765);for(var f=0;f<16;f++){for(var l=i[f],j=this._lBlock,g=this._rBlock,h=0,b=0;b<8;b++)h|=m[b][((g^l[b])&k[b])>>>0];this._lBlock=g;this._rBlock=j^h}var n=this._lBlock;this._lBlock=this._rBlock;this._rBlock=n;a.call(this,1,1431655765);c.call(this,8,16711935);c.call(this,2,858993459);a.call(this,16,65535);a.call(this,4,252645135);e[d]=this._lBlock;e[d+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function a(a,c){var b=(this._lBlock>>>a^this._rBlock)&c;this._rBlock^=b;this._lBlock^=b<<a}function c(a,c){var b=(this._rBlock>>>a^this._lBlock)&c;this._lBlock^=b;this._rBlock^=b<<a}e.DES=b._createHelper(d);var l=g.TripleDES=b.extend({_doReset:function(){var b=this._key,a=b.words;this._des1=d.createEncryptor(f.create(a.slice(0,2)));this._des2=d.createEncryptor(f.create(a.slice(2,4)));this._des3=d.createEncryptor(f.create(a.slice(4,6)))},encryptBlock:function(b,a){this._des1.encryptBlock(b,a);this._des2.decryptBlock(b,a);this._des3.encryptBlock(b,a)},decryptBlock:function(b,a){this._des3.decryptBlock(b,a);this._des2.encryptBlock(b,a);this._des1.decryptBlock(b,a)},keySize:192/32,ivSize:64/32,blockSize:64/32});e.TripleDES=b._createHelper(l)})();(function(){var a=CryptoJS,d=a.lib,b=d.WordArray,c=a.enc,e=c.Base64={stringify:function(d){var e=d.words,g=d.sigBytes,h=this._map;d.clamp();for(var b=[],a=0;a<g;a+=3)for(var j=e[a>>>2]>>>24-a%4*8&255,k=e[a+1>>>2]>>>24-(a+1)%4*8&255,l=e[a+2>>>2]>>>24-(a+2)%4*8&255,i=j<<16|k<<8|l,c=0;c<4&&a+c*.75<g;c++)b.push(h.charAt(i>>>6*(3-c)&63));var f=h.charAt(64);if(f)while(b.length%4)b.push(f);return b.join("")},parse:function(c){var f=c.length,e=this._map,h=e.charAt(64);if(h){var g=c.indexOf(h);if(g!=-1)f=g}for(var i=[],d=0,a=0;a<f;a++)if(a%4){var j=e.indexOf(c.charAt(a-1))<<a%4*2,k=e.indexOf(c.charAt(a))>>>6-a%4*2;i[d>>>2]|=(j|k)<<24-d%4*8;d++}return b.create(i,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();
/* (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
var dbits,canary=0xdeadbeefcafe,j_lm=(canary&16777215)==15715070;function BigInteger(a,b,c){if(a!=null)if("number"==typeof a)this.fromNumber(a,b,c);else if(b==null&&"string"!=typeof a)this.fromString(a,256);else this.fromString(a,b)}function nbi(){return new BigInteger(null)}function am1(e,g,d,b,a,f){while(--f>=0){var c=g*this[e++]+d[b]+a;a=Math.floor(c/67108864);d[b++]=c&67108863}return a}function am2(f,j,i,g,b,k){var d=j&32767,c=j>>15;while(--k>=0){var a=this[f]&32767,e=this[f++]>>15,h=c*a+e*d;a=d*a+((h&32767)<<15)+i[g]+(b&1073741823);b=(a>>>30)+(h>>>15)+c*e+(b>>>30);i[g++]=a&1073741823}return b}function am3(f,j,i,g,b,k){var d=j&16383,c=j>>14;while(--k>=0){var a=this[f]&16383,e=this[f++]>>14,h=c*a+e*d;a=d*a+((h&16383)<<14)+i[g]+b;b=(a>>28)+(h>>14)+c*e;i[g++]=a&268435455}return b}if(j_lm&&navigator.appName=="Microsoft Internet Explorer"){BigInteger.prototype.am=am2;dbits=30}else if(j_lm&&navigator.appName!="Netscape"){BigInteger.prototype.am=am1;dbits=26}else{BigInteger.prototype.am=am3;dbits=28}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=(1<<dbits)-1;BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=[],rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv)BI_RC[rr++]=vv;rr="a".charCodeAt(0);for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;rr="A".charCodeAt(0);for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(a){return BI_RM.charAt(a)}function intAt(c,b){var a=BI_RC[c.charCodeAt(b)];return a==null?-1:a}function bnpCopyTo(b){for(var a=this.t-1;a>=0;--a)b[a]=this[a];b.t=this.t;b.s=this.s}function bnpFromInt(a){this.t=1;this.s=a<0?-1:0;if(a>0)this[0]=a;else if(a<-1)this[0]=a+this.DV;else this.t=0}function nbv(b){var a=nbi();a.fromInt(b);return a}function bnpFromString(d,c){var b;if(c==16)b=4;else if(c==8)b=3;else if(c==256)b=8;else if(c==2)b=1;else if(c==32)b=5;else if(c==4)b=2;else{this.fromRadix(d,c);return}this.t=0;this.s=0;var f=d.length,g=false,a=0;while(--f>=0){var e=b==8?d[f]&255:intAt(d,f);if(e<0){if(d.charAt(f)=="-")g=true;continue}g=false;if(a==0)this[this.t++]=e;else if(a+b>this.DB){this[this.t-1]|=(e&(1<<this.DB-a)-1)<<a;this[this.t++]=e>>this.DB-a}else this[this.t-1]|=e<<a;a+=b;if(a>=this.DB)a-=this.DB}if(b==8&&(d[0]&128)!=0){this.s=-1;if(a>0)this[this.t-1]|=(1<<this.DB-a)-1<<a}this.clamp();g&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){var a=this.s&this.DM;while(this.t>0&&this[this.t-1]==a)--this.t}function bnToString(d){if(this.s<0)return"-"+this.negate().toString(d);var a;if(d==16)a=4;else if(d==8)a=3;else if(d==2)a=1;else if(d==32)a=5;else if(d==4)a=2;else return this.toRadix(d);var h=(1<<a)-1,e,f=false,g="",c=this.t,b=this.DB-c*this.DB%a;if(c-->0){if(b<this.DB&&(e=this[c]>>b)>0){f=true;g=int2char(e)}while(c>=0){if(b<a){e=(this[c]&(1<<b)-1)<<a-b;e|=this[--c]>>(b+=this.DB-a)}else{e=this[c]>>(b-=a)&h;if(b<=0){b+=this.DB;--c}}if(e>0)f=true;if(f)g+=int2char(e)}}return f?g:"0"}function bnNegate(){var a=nbi();BigInteger.ZERO.subTo(this,a);return a}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(c){var a=this.s-c.s;if(a!=0)return a;var b=this.t;a=b-c.t;if(a!=0)return this.s<0?-a:a;while(--b>=0)if((a=this[b]-c[b])!=0)return a;return 0}function nbits(b){var c=1,a;if((a=b>>>16)!=0){b=a;c+=16}if((a=b>>8)!=0){b=a;c+=8}if((a=b>>4)!=0){b=a;c+=4}if((a=b>>2)!=0){b=a;c+=2}if((a=b>>1)!=0){b=a;c+=1}return c}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(c,b){for(var a=this.t-1;a>=0;--a)b[a+c]=this[a];for(a=c-1;a>=0;--a)b[a]=0;b.t=this.t+c;b.s=this.s}function bnpDRShiftTo(b,c){for(var a=b;a<this.t;++a)c[a-b]=this[a];c.t=Math.max(this.t-b,0);c.s=this.s}function bnpLShiftTo(g,b){for(var d=g%this.DB,f=this.DB-d,h=(1<<f)-1,c=Math.floor(g/this.DB),e=this.s<<d&this.DM,a=this.t-1;a>=0;--a){b[a+c+1]=this[a]>>f|e;e=(this[a]&h)<<d}for(a=c-1;a>=0;--a)b[a]=0;b[c]=e;b.t=this.t+c+1;b.s=this.s;b.clamp()}function bnpRShiftTo(g,a){a.s=this.s;var b=Math.floor(g/this.DB);if(b>=this.t){a.t=0;return}var d=g%this.DB,e=this.DB-d,f=(1<<d)-1;a[0]=this[b]>>d;for(var c=b+1;c<this.t;++c){a[c-b-1]|=(this[c]&f)<<e;a[c-b]=this[c]>>d}if(d>0)a[this.t-b-1]|=(this.s&f)<<e;a.t=this.t-b;a.clamp()}function bnpSubTo(d,c){var b=0,a=0,e=Math.min(d.t,this.t);while(b<e){a+=this[b]-d[b];c[b++]=a&this.DM;a>>=this.DB}if(d.t<this.t){a-=d.s;while(b<this.t){a+=this[b];c[b++]=a&this.DM;a>>=this.DB}a+=this.s}else{a+=this.s;while(b<d.t){a-=d[b];c[b++]=a&this.DM;a>>=this.DB}a-=d.s}c.s=a<0?-1:0;if(a<-1)c[b++]=this.DV+a;else if(a>0)c[b++]=a;c.t=b;c.clamp()}function bnpMultiplyTo(e,b){var c=this.abs(),d=e.abs(),a=c.t;b.t=a+d.t;while(--a>=0)b[a]=0;for(a=0;a<d.t;++a)b[a+c.t]=c.am(0,d[a],b,a,0,c.t);b.s=0;b.clamp();this.s!=e.s&&BigInteger.ZERO.subTo(b,b)}function bnpSquareTo(c){var b=this.abs(),a=c.t=2*b.t;while(--a>=0)c[a]=0;for(a=0;a<b.t-1;++a){var d=b.am(a,b[a],c,2*a,0,1);if((c[a+b.t]+=b.am(a+1,2*b[a],c,2*a+1,d,b.t-a-1))>=b.DV){c[a+b.t]-=b.DV;c[a+b.t+1]=1}}if(c.t>0)c[c.t-1]+=b.am(a,b[a],c,2*a,0,1);c.s=0;c.clamp()}function bnpDivRemTo(o,d,a){var f=o.abs();if(f.t<=0)return;var j=this.abs();if(j.t<f.t){d!=null&&d.fromInt(0);a!=null&&this.copyTo(a);return}if(a==null)a=nbi();var b=nbi(),m=this.s,r=o.s,h=this.DB-nbits(f[f.t-1]);if(h>0){f.lShiftTo(h,b);j.lShiftTo(h,a)}else{f.copyTo(b);j.copyTo(a)}var c=b.t,l=b[c-1];if(l==0)return;var n=l*(1<<this.F1)+(c>1?b[c-2]>>this.F2:0),p=this.FV/n,q=(1<<this.F1)/n,s=1<<this.F2,g=a.t,i=g-c,e=d==null?nbi():d;b.dlShiftTo(i,e);if(a.compareTo(e)>=0){a[a.t++]=1;a.subTo(e,a)}BigInteger.ONE.dlShiftTo(c,e);e.subTo(b,b);while(b.t<c)b[b.t++]=0;while(--i>=0){var k=a[--g]==l?this.DM:Math.floor(a[g]*p+(a[g-1]+s)*q);if((a[g]+=b.am(0,k,a,i,0,c))<k){b.dlShiftTo(i,e);a.subTo(e,a);while(a[g]<--k)a.subTo(e,a)}}if(d!=null){a.drShiftTo(c,d);m!=r&&BigInteger.ZERO.subTo(d,d)}a.t=c;a.clamp();h>0&&a.rShiftTo(h,a);m<0&&BigInteger.ZERO.subTo(a,a)}function bnMod(b){var a=nbi();this.abs().divRemTo(b,null,a);this.s<0&&a.compareTo(BigInteger.ZERO)>0&&b.subTo(a,a);return a}function Classic(a){this.m=a}function cConvert(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function cRevert(a){return a}function cReduce(a){a.divRemTo(this.m,null,a)}function cMulTo(b,c,a){b.multiplyTo(c,a);this.reduce(a)}function cSqrTo(b,a){b.squareTo(a);this.reduce(a)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1)return 0;var b=this[0];if((b&1)==0)return 0;var a=b&3;a=a*(2-(b&15)*a)&15;a=a*(2-(b&255)*a)&255;a=a*(2-((b&65535)*a&65535))&65535;a=a*(2-b*a%this.DV)%this.DV;return a>0?this.DV-a:-a}function Montgomery(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}function montConvert(b){var a=nbi();b.abs().dlShiftTo(this.m.t,a);a.divRemTo(this.m,null,a);b.s<0&&a.compareTo(BigInteger.ZERO)>0&&this.m.subTo(a,a);return a}function montRevert(b){var a=nbi();b.copyTo(a);this.reduce(a);return a}function montReduce(a){while(a.t<=this.mt2)a[a.t++]=0;for(var c=0;c<this.m.t;++c){var b=a[c]&32767,d=b*this.mpl+((b*this.mph+(a[c]>>15)*this.mpl&this.um)<<15)&a.DM;b=c+this.m.t;a[b]+=this.m.am(0,d,a,c,0,this.m.t);while(a[b]>=a.DV){a[b]-=a.DV;a[++b]++}}a.clamp();a.drShiftTo(this.m.t,a);a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function montSqrTo(b,a){b.squareTo(a);this.reduce(a)}function montMulTo(b,c,a){b.multiplyTo(c,a);this.reduce(a)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return(this.t>0?this[0]&1:this.s)==0}function bnpExp(c,d){if(c>4294967295||c<1)return BigInteger.ONE;var a=nbi(),b=nbi(),e=d.convert(this),f=nbits(c)-1;e.copyTo(a);while(--f>=0){d.sqrTo(a,b);if((c&1<<f)>0)d.mulTo(b,e,a);else{var g=a;a=b;b=g}}return d.revert(a)}function bnModPowInt(c,a){var b;if(c<256||a.isEven())b=new Classic(a);else b=new Montgomery(a);return this.exp(c,b)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);
/* (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function bnClone(){var a=nbi();this.copyTo(a);return a}function bnIntValue(){if(this.s<0){if(this.t==1)return this[0]-this.DV;else if(this.t==0)return-1}else if(this.t==1)return this[0];else if(this.t==0)return 0;return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return this.t==0?this.s:this[0]<<24>>24}function bnShortValue(){return this.t==0?this.s:this[0]<<16>>16}function bnpChunkSize(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function bnSigNum(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function bnpToRadix(a){if(a==null)a=10;if(this.signum()==0||a<2||a>36)return"0";var g=this.chunkSize(a),e=Math.pow(a,g),f=nbv(e),b=nbi(),c=nbi(),d="";this.divRemTo(f,b,c);while(b.signum()>0){d=(e+c.intValue()).toString(a).substr(1)+d;b.divRemTo(f,b,c)}return c.intValue().toString(a)+d}function bnpFromRadix(e,a){this.fromInt(0);if(a==null)a=10;for(var f=this.chunkSize(a),i=Math.pow(a,f),g=false,d=0,b=0,c=0;c<e.length;++c){var h=intAt(e,c);if(h<0){if(e.charAt(c)=="-"&&this.signum()==0)g=true;continue}b=a*b+h;if(++d>=f){this.dMultiply(i);this.dAddOffset(b,0);d=0;b=0}}if(d>0){this.dMultiply(Math.pow(a,d));this.dAddOffset(b,0)}g&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(a,c,e){if("number"==typeof c)if(a<2)this.fromInt(1);else{this.fromNumber(a,e);!this.testBit(a-1)&&this.bitwiseTo(BigInteger.ONE.shiftLeft(a-1),op_or,this);this.isEven()&&this.dAddOffset(1,0);while(!this.isProbablePrime(c)){this.dAddOffset(2,0);this.bitLength()>a&&this.subTo(BigInteger.ONE.shiftLeft(a-1),this)}}else{var b=[],d=a&7;b.length=(a>>3)+1;c.nextBytes(b);if(d>0)b[0]&=(1<<d)-1;else b[0]=0;this.fromString(b,256)}}function bnToByteArray(){var c=this.t,e=[];e[0]=this.s;var a=this.DB-c*this.DB%8,b,d=0;if(c-->0){if(a<this.DB&&(b=this[c]>>a)!=(this.s&this.DM)>>a)e[d++]=b|this.s<<this.DB-a;while(c>=0){if(a<8){b=(this[c]&(1<<a)-1)<<8-a;b|=this[--c]>>(a+=this.DB-8)}else{b=this[c]>>(a-=8)&255;if(a<=0){a+=this.DB;--c}}if((b&128)!=0)b|=-256;if(d==0&&(this.s&128)!=(b&128))++d;if(d>0||b!=this.s)e[d++]=b}}return e}function bnEquals(a){return this.compareTo(a)==0}function bnMin(a){return this.compareTo(a)<0?this:a}function bnMax(a){return this.compareTo(a)>0?this:a}function bnpBitwiseTo(b,d,c){for(var e,f=Math.min(b.t,this.t),a=0;a<f;++a)c[a]=d(this[a],b[a]);if(b.t<this.t){e=b.s&this.DM;for(a=f;a<this.t;++a)c[a]=d(this[a],e);c.t=this.t}else{e=this.s&this.DM;for(a=f;a<b.t;++a)c[a]=d(e,b[a]);c.t=b.t}c.s=d(this.s,b.s);c.clamp()}function op_and(a,b){return a&b}function bnAnd(b){var a=nbi();this.bitwiseTo(b,op_and,a);return a}function op_or(a,b){return a|b}function bnOr(b){var a=nbi();this.bitwiseTo(b,op_or,a);return a}function op_xor(a,b){return a^b}function bnXor(b){var a=nbi();this.bitwiseTo(b,op_xor,a);return a}function op_andnot(a,b){return a&~b}function bnAndNot(b){var a=nbi();this.bitwiseTo(b,op_andnot,a);return a}function bnNot(){for(var b=nbi(),a=0;a<this.t;++a)b[a]=this.DM&~this[a];b.t=this.t;b.s=~this.s;return b}function bnShiftLeft(a){var b=nbi();if(a<0)this.rShiftTo(-a,b);else this.lShiftTo(a,b);return b}function bnShiftRight(a){var b=nbi();if(a<0)this.lShiftTo(-a,b);else this.rShiftTo(a,b);return b}function lbit(a){if(a==0)return-1;var b=0;if((a&65535)==0){a>>=16;b+=16}if((a&255)==0){a>>=8;b+=8}if((a&15)==0){a>>=4;b+=4}if((a&3)==0){a>>=2;b+=2}if((a&1)==0)++b;return b}function bnGetLowestSetBit(){for(var a=0;a<this.t;++a)if(this[a]!=0)return a*this.DB+lbit(this[a]);return this.s<0?this.t*this.DB:-1}function cbit(a){var b=0;while(a!=0){a&=a-1;++b}return b}function bnBitCount(){for(var b=0,c=this.s&this.DM,a=0;a<this.t;++a)b+=cbit(this[a]^c);return b}function bnTestBit(b){var a=Math.floor(b/this.DB);return a>=this.t?this.s!=0:(this[a]&1<<b%this.DB)!=0}function bnpChangeBit(c,b){var a=BigInteger.ONE.shiftLeft(c);this.bitwiseTo(a,b,a);return a}function bnSetBit(a){return this.changeBit(a,op_or)}function bnClearBit(a){return this.changeBit(a,op_andnot)}function bnFlipBit(a){return this.changeBit(a,op_xor)}function bnpAddTo(d,c){var b=0,a=0,e=Math.min(d.t,this.t);while(b<e){a+=this[b]+d[b];c[b++]=a&this.DM;a>>=this.DB}if(d.t<this.t){a+=d.s;while(b<this.t){a+=this[b];c[b++]=a&this.DM;a>>=this.DB}a+=this.s}else{a+=this.s;while(b<d.t){a+=d[b];c[b++]=a&this.DM;a>>=this.DB}a+=d.s}c.s=a<0?-1:0;if(a>0)c[b++]=a;else if(a<-1)c[b++]=this.DV+a;c.t=b;c.clamp()}function bnAdd(b){var a=nbi();this.addTo(b,a);return a}function bnSubtract(b){var a=nbi();this.subTo(b,a);return a}function bnMultiply(b){var a=nbi();this.multiplyTo(b,a);return a}function bnSquare(){var a=nbi();this.squareTo(a);return a}function bnDivide(b){var a=nbi();this.divRemTo(b,a,null);return a}function bnRemainder(b){var a=nbi();this.divRemTo(b,null,a);return a}function bnDivideAndRemainder(c){var a=nbi(),b=nbi();this.divRemTo(c,a,b);return[a,b]}function bnpDMultiply(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(b,a){if(b==0)return;while(this.t<=a)this[this.t++]=0;this[a]+=b;while(this[a]>=this.DV){this[a]-=this.DV;if(++a>=this.t)this[this.t++]=0;++this[a]}}function NullExp(){}function nNop(a){return a}function nMulTo(b,c,a){b.multiplyTo(c,a)}function nSqrTo(b,a){b.squareTo(a)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(a){return this.exp(a,new NullExp)}function bnpMultiplyLowerTo(c,e,b){var a=Math.min(this.t+c.t,e);b.s=0;b.t=a;while(a>0)b[--a]=0;for(var d=b.t-this.t;a<d;++a)b[a+this.t]=this.am(0,c[a],b,a,0,this.t);for(d=Math.min(c.t,e);a<d;++a)this.am(0,c[a],b,a,0,e-a);b.clamp()}function bnpMultiplyUpperTo(d,c,b){--c;var a=b.t=this.t+d.t-c;b.s=0;while(--a>=0)b[a]=0;for(a=Math.max(c-this.t,0);a<d.t;++a)b[this.t+a-c]=this.am(c-a,d[a],b,0,0,this.t+a-c);b.clamp();b.drShiftTo(1,b)}function Barrett(a){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a);this.m=a}function barrettConvert(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);else if(a.compareTo(this.m)<0)return a;else{var b=nbi();a.copyTo(b);this.reduce(b);return b}}function barrettRevert(a){return a}function barrettReduce(a){a.drShiftTo(this.m.t-1,this.r2);if(a.t>this.m.t+1){a.t=this.m.t+1;a.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(a.compareTo(this.r2)<0)a.dAddOffset(1,this.m.t+1);a.subTo(this.r2,a);while(a.compareTo(this.m)>=0)a.subTo(this.m,a)}function barrettSqrTo(b,a){b.squareTo(a);this.reduce(a)}function barrettMulTo(b,c,a){b.multiplyTo(c,a);this.reduce(a)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(h,l){var a=h.bitLength(),g,b=nbv(1),c;if(a<=0)return b;else if(a<18)g=1;else if(a<48)g=3;else if(a<144)g=4;else if(a<768)g=5;else g=6;if(a<8)c=new Classic(l);else if(l.isEven())c=new Barrett(l);else c=new Montgomery(l);var i=[],d=3,k=g-1,p=(1<<g)-1;i[1]=c.convert(this);if(g>1){var o=nbi();c.sqrTo(i[1],o);while(d<=p){i[d]=nbi();c.mulTo(o,i[d-2],i[d]);d+=2}}var e=h.t-1,j,n=true,f=nbi(),m;a=nbits(h[e])-1;while(e>=0){if(a>=k)j=h[e]>>a-k&p;else{j=(h[e]&(1<<a+1)-1)<<k-a;if(e>0)j|=h[e-1]>>this.DB+a-k}d=g;while((j&1)==0){j>>=1;--d}if((a-=d)<0){a+=this.DB;--e}if(n){i[j].copyTo(b);n=false}else{while(d>1){c.sqrTo(b,f);c.sqrTo(f,b);d-=2}if(d>0)c.sqrTo(b,f);else{m=b;b=f;f=m}c.mulTo(f,i[j],b)}while(e>=0&&(h[e]&1<<a)==0){c.sqrTo(b,f);m=b;b=f;f=m;if(--a<0){a=this.DB-1;--e}}}return c.revert(b)}function bnGCD(e){var b=this.s<0?this.negate():this.clone(),a=e.s<0?e.negate():e.clone();if(b.compareTo(a)<0){var f=b;b=a;a=f}var d=b.getLowestSetBit(),c=a.getLowestSetBit();if(c<0)return b;if(d<c)c=d;if(c>0){b.rShiftTo(c,b);a.rShiftTo(c,a)}while(b.signum()>0){(d=b.getLowestSetBit())>0&&b.rShiftTo(d,b);(d=a.getLowestSetBit())>0&&a.rShiftTo(d,a);if(b.compareTo(a)>=0){b.subTo(a,b);b.rShiftTo(1,b)}else{a.subTo(b,a);a.rShiftTo(1,a)}}c>0&&a.lShiftTo(c,a);return a}function bnpModInt(a){if(a<=0)return 0;var d=this.DV%a,b=this.s<0?a-1:0;if(this.t>0)if(d==0)b=this[0]%a;else for(var c=this.t-1;c>=0;--c)b=(d*b+this[c])%a;return b}function bnModInverse(c){var h=c.isEven();if(this.isEven()&&h||c.signum()==0)return BigInteger.ZERO;var f=c.clone(),g=this.clone(),d=nbv(1),b=nbv(0),e=nbv(0),a=nbv(1);while(f.signum()!=0){while(f.isEven()){f.rShiftTo(1,f);if(h){if(!d.isEven()||!b.isEven()){d.addTo(this,d);b.subTo(c,b)}d.rShiftTo(1,d)}else!b.isEven()&&b.subTo(c,b);b.rShiftTo(1,b)}while(g.isEven()){g.rShiftTo(1,g);if(h){if(!e.isEven()||!a.isEven()){e.addTo(this,e);a.subTo(c,a)}e.rShiftTo(1,e)}else!a.isEven()&&a.subTo(c,a);a.rShiftTo(1,a)}if(f.compareTo(g)>=0){f.subTo(g,f);h&&d.subTo(e,d);b.subTo(a,b)}else{g.subTo(f,g);h&&e.subTo(d,e);a.subTo(b,a)}}if(g.compareTo(BigInteger.ONE)!=0)return BigInteger.ZERO;if(a.compareTo(c)>=0)return a.subtract(c);if(a.signum()<0)a.addTo(c,a);else return a;return a.signum()<0?a.add(c):a}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(e){var a,b=this.abs();if(b.t==1&&b[0]<=lowprimes[lowprimes.length-1]){for(a=0;a<lowprimes.length;++a)if(b[0]==lowprimes[a])return true;return false}if(b.isEven())return false;a=1;while(a<lowprimes.length){var c=lowprimes[a],d=a+1;while(d<lowprimes.length&&c<lplim)c*=lowprimes[d++];c=b.modInt(c);while(a<d)if(c%lowprimes[a++]==0)return false}return b.millerRabin(e)}function bnpMillerRabin(c){var b=this.subtract(BigInteger.ONE),d=b.getLowestSetBit();if(d<=0)return false;var h=b.shiftRight(d);c=c+1>>1;if(c>lowprimes.length)c=lowprimes.length;for(var e=nbi(),f=0;f<c;++f){e.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var a=e.modPow(h,this);if(a.compareTo(BigInteger.ONE)!=0&&a.compareTo(b)!=0){var g=1;while(g++<d&&a.compareTo(b)!=0){a=a.modPowInt(2,this);if(a.compareTo(BigInteger.ONE)==0)return false}if(a.compareTo(b)!=0)return false}}return true}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.prototype.square=bnSquare;
/* (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function Arcfour(){this.i=0;this.j=0;this.S=[]}function ARC4init(c){for(var b,d,a=0;a<256;++a)this.S[a]=a;b=0;for(a=0;a<256;++a){b=b+this.S[a]+c[a%c.length]&255;d=this.S[a];this.S[a]=this.S[b];this.S[b]=d}this.i=0;this.j=0}function ARC4next(){var a;this.i=this.i+1&255;this.j=this.j+this.S[this.i]&255;a=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=a;return this.S[a+this.S[this.i]&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour}var rng_psize=256;
/* (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
var rng_state,rng_pool,rng_pptr;function rng_seed_int(a){rng_pool[rng_pptr++]^=a&255;rng_pool[rng_pptr++]^=a>>8&255;rng_pool[rng_pptr++]^=a>>16&255;rng_pool[rng_pptr++]^=a>>24&255;if(rng_pptr>=rng_psize)rng_pptr-=rng_psize}function rng_seed_time(){rng_seed_int((new Date).getTime())}if(rng_pool==null){rng_pool=[];rng_pptr=0;var t;if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=z.charCodeAt(t)&255}while(rng_pptr<rng_psize){t=Math.floor(65536*Math.random());rng_pool[rng_pptr++]=t>>>8;rng_pool[rng_pptr++]=t&255}rng_pptr=0;rng_seed_time()}function rng_get_byte(){if(rng_state==null){rng_seed_time();rng_state=prng_newstate();rng_state.init(rng_pool);for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(b){for(var a=0;a<b.length;++a)b[a]=rng_get_byte()}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;
/* crypto-1.1.5.js (c) 2013 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
if(typeof KJUR=="undefined"||!KJUR)KJUR={};if(typeof KJUR.crypto=="undefined"||!KJUR.crypto)KJUR.crypto={};KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"};this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",sm3:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"};this.CRYPTOJSMESSAGEDIGESTNAME={md5:"CryptoJS.algo.MD5",sha1:"CryptoJS.algo.SHA1",sha224:"CryptoJS.algo.SHA224",sha256:"CryptoJS.algo.SHA256",sha384:"CryptoJS.algo.SHA384",sha512:"CryptoJS.algo.SHA512",ripemd160:"CryptoJS.algo.RIPEMD160",sm3:"CryptoJS.algo.SM3"};this.getDigestInfoHex=function(b,a){if(typeof this.DIGESTINFOHEAD[a]=="undefined")throw"alg not supported in Util.DIGESTINFOHEAD: "+a;return this.DIGESTINFOHEAD[a]+b};this.getPaddedDigestInfoHex=function(j,g,c){var a=this.getDigestInfoHex(j,g),b=c/4;if(a.length+22>b)throw"key is too short for SigAlg: keylen="+c+","+g;for(var d="0001",e="00"+a,f="",k=b-d.length-e.length,h=0;h<k;h+=2)f+="ff";var i=d+f+e;return i};this.hashString=function(c,a){var b=new KJUR.crypto.MessageDigest({alg:a});return b.digestString(c)};this.hashHex=function(a,b){var c=new KJUR.crypto.MessageDigest({alg:b});return c.digestHex(a)};this.sha1=function(b){var a=new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"});return a.digestString(b)};this.sha256=function(b){var a=new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return a.digestString(b)};this.sha256Hex=function(b){var a=new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return a.digestHex(b)};this.sha512=function(b){var a=new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return a.digestString(b)};this.sha512Hex=function(b){var a=new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return a.digestHex(b)};this.md5=function(b){var a=new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return a.digestString(b)};this.ripemd160=function(b){var a=new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return a.digestString(b)};this.getCryptoJSMDByName=function(){}};KJUR.crypto.MessageDigest=function(a){var d=null,c=null,b=null;this.setAlgAndProvider=function(a,b){if(a!=null&&b===undefined)b=KJUR.crypto.Util.DEFAULTPROVIDER[a];if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:sm3:".indexOf(a)!=-1&&b=="cryptojs"){try{this.md=(eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[a])).create()}catch(c){throw"setAlgAndProvider hash alg set fail alg="+a+"/"+c;}this.updateString=function(a){this.md.update(a)};this.updateHex=function(b){var a=CryptoJS.enc.Hex.parse(b);this.md.update(a)};this.digest=function(){var a=this.md.finalize();return a.toString(CryptoJS.enc.Hex)};this.digestString=function(a){this.updateString(a);return this.digest()};this.digestHex=function(a){this.updateHex(a);return this.digest()}}if(":sha256:".indexOf(a)!=-1&&b=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(c){throw"setAlgAndProvider hash alg set fail alg="+a+"/"+c;}this.updateString=function(a){this.md.update(a)};this.updateHex=function(b){var a=sjcl.codec.hex.toBits(b);this.md.update(a)};this.digest=function(){var a=this.md.finalize();return sjcl.codec.hex.fromBits(a)};this.digestString=function(a){this.updateString(a);return this.digest()};this.digestHex=function(a){this.updateHex(a);return this.digest()}}};this.updateString=function(){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName;};this.updateHex=function(){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName;};this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName;};this.digestString=function(){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName;};this.digestHex=function(){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName;};if(a!==undefined)if(a.alg!==undefined){this.algName=a.alg;if(a.prov===undefined)this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName];this.setAlgAndProvider(this.algName,this.provName)}};KJUR.crypto.Mac=function(a){var f=null,e=null,c=null,b=null,d=null;this.setAlgAndProvider=function(a,b){if(a==null)a="hmacsha1";a=a.toLowerCase();if(a.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+a;if(b===undefined)b=KJUR.crypto.Util.DEFAULTPROVIDER[a];this.algProv=a+"/"+b;var c=a.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(c)!=-1&&b=="cryptojs"){try{var d=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[c]);this.mac=CryptoJS.algo.HMAC.create(d,this.pass)}catch(e){throw"setAlgAndProvider hash alg set fail hashAlg="+c+"/"+e;}this.updateString=function(a){this.mac.update(a)};this.updateHex=function(b){var a=CryptoJS.enc.Hex.parse(b);this.mac.update(a)};this.doFinal=function(){var a=this.mac.finalize();return a.toString(CryptoJS.enc.Hex)};this.doFinalString=function(a){this.updateString(a);return this.doFinal()};this.doFinalHex=function(a){this.updateHex(a);return this.doFinal()}}};this.updateString=function(){throw"updateString(str) not supported for this alg/prov: "+this.algProv;};this.updateHex=function(){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv;};this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv;};this.doFinalString=function(){throw"digestString(str) not supported for this alg/prov: "+this.algProv;};this.doFinalHex=function(){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv;};if(a!==undefined){if(a.pass!==undefined)this.pass=a.pass;if(a.alg!==undefined){this.algName=a.alg;if(a.prov===undefined)this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName];this.setAlgAndProvider(this.algName,this.provName)}}};KJUR.crypto.Signature=function(a){var b=null,m=null,r=null,p=null,l=null,j=null,e=null,i=null,d=null,o=null,h=-1,g=null,k=null,f=null,c=null,n=null;this._setAlgNames=function(){if(this.algName.match(/^(.+)with(.+)$/)){this.mdAlgName=RegExp.$1.toLowerCase();this.pubkeyAlgName=RegExp.$2.toLowerCase()}};this._zeroPaddingOfSignature=function(b,d){for(var a="",e=d/4-b.length,c=0;c<e;c++)a=a+"0";return a+b};this.setAlgAndProvider=function(b,a){this._setAlgNames();if(a!="cryptojs/jsrsa")throw"provider not supported: "+a;if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:sm3:".indexOf(this.mdAlgName)!=-1){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}catch(c){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+c;}this.init=function(b,c){var a=null;try{if(c===undefined)a=KEYUTIL.getKey(b);else a=KEYUTIL.getKey(b,c)}catch(d){throw"init failed:"+d;}if(a.isPrivate===true){this.prvKey=a;this.state="SIGN"}else if(a.isPublic===true){this.pubKey=a;this.state="VERIFY"}else throw"init failed.:"+a;};this.initSign=function(a){if(typeof a.ecprvhex=="string"&&typeof a.eccurvename=="string"){this.ecprvhex=a.ecprvhex;this.eccurvename=a.eccurvename}else this.prvKey=a;this.state="SIGN"};this.initVerifyByPublicKey=function(a){if(typeof a.ecpubhex=="string"&&typeof a.eccurvename=="string"){this.ecpubhex=a.ecpubhex;this.eccurvename=a.eccurvename}else if(a instanceof KJUR.crypto.ECDSA)this.pubKey=a;else if(a instanceof RSAKey)this.pubKey=a;this.state="VERIFY"};this.initVerifyByCertificatePEM=function(b){var a=new X509;a.readCertPEM(b);this.pubKey=a.subjectPublicKeyRSA;this.state="VERIFY"};this.updateString=function(a){this.md.updateString(a)};this.updateHex=function(a){this.md.updateHex(a)};this.sign=function(){if(this.eccurvename!="sm2")this.sHashHex=this.md.digest();if(typeof this.ecprvhex!="undefined"&&typeof this.eccurvename!="undefined")if(this.eccurvename=="sm2"){var c=new KJUR.crypto.SM3withSM2({curve:this.eccurvename}),f=c.ecparams.G,g=f.multiply(new BigInteger(this.ecprvhex,16)),h=g.getX().toBigInteger().toRadix(16)+g.getY().toBigInteger().toRadix(16),a=new SM3Digest,j=(new SM3Digest).GetZ(f,h),e=a.GetWords(a.GetHex(j).toString()),b=CryptoJS.enc.Utf8.stringify(this.md.md._data);b=CryptoJS.enc.Utf8.parse(b).toString();b=a.GetWords(b);var d=new Array(a.GetDigestSize());a.BlockUpdate(e,0,e.length);a.BlockUpdate(b,0,b.length);a.DoFinal(d,0);var i=a.GetHex(d).toString();this.sHashHex=i;this.hSign=c.signHex(this.sHashHex,this.ecprvhex)}else{var c=new KJUR.crypto.ECDSA({curve:this.eccurvename});this.hSign=c.signHex(this.sHashHex,this.ecprvhex)}else if(this.pubkeyAlgName=="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.pubkeyAlgName=="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof KJUR.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof KJUR.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported public key alg: "+this.pubkeyAlgName;return this.hSign};this.signString=function(a){this.updateString(a);this.sign()};this.signHex=function(a){this.updateHex(a);this.sign()};this.verify=function(b){if(this.eccurvename!="sm2")this.sHashHex=this.md.digest();if(typeof this.ecpubhex!="undefined"&&typeof this.eccurvename!="undefined")if(this.eccurvename=="sm2"){var d=new KJUR.crypto.SM3withSM2({curve:this.eccurvename}),i=d.ecparams.G,g=this.ecpubhex.substr(2,128),a=new SM3Digest,j=(new SM3Digest).GetZ(i,g),f=a.GetWords(a.GetHex(j).toString()),c=CryptoJS.enc.Utf8.stringify(this.md.md._data);c=CryptoJS.enc.Utf8.parse(c).toString();c=a.GetWords(c);var e=new Array(a.GetDigestSize());a.BlockUpdate(f,0,f.length);a.BlockUpdate(c,0,c.length);a.DoFinal(e,0);var h=a.GetHex(e).toString();this.sHashHex=h;return d.verifyHex(this.sHashHex,b,this.ecpubhex)}else{var d=new KJUR.crypto.ECDSA({curve:this.eccurvename});return d.verifyHex(this.sHashHex,b,this.ecpubhex)}else if(this.pubkeyAlgName=="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,b,this.mdAlgName,this.pssSaltLen);else if(this.pubkeyAlgName=="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,b);else if(this.pubKey instanceof KJUR.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,b);else if(this.pubKey instanceof KJUR.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,b);else throw"Signature: unsupported public key alg: "+this.pubkeyAlgName;}}};this.init=function(){throw"init(key, pass) not supported for this alg:prov="+this.algProvName;};this.initVerifyByPublicKey=function(){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName;};this.initVerifyByCertificatePEM=function(){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName;};this.initSign=function(){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName;};this.updateString=function(){throw"updateString(str) not supported for this alg:prov="+this.algProvName;};this.updateHex=function(){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName;};this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName;};this.signString=function(){throw"digestString(str) not supported for this alg:prov="+this.algProvName;};this.signHex=function(){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName;};this.verify=function(){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName;};this.initParams=a;if(a!==undefined){if(a.alg!==undefined){this.algName=a.alg;if(a.prov===undefined)this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName];else this.provName=a.prov;this.algProvName=this.algName+":"+this.provName;this.setAlgAndProvider(this.algName,this.provName);this._setAlgNames()}if(a.psssaltlen!==undefined)this.pssSaltLen=a.psssaltlen;if(a.prvkeypem!==undefined)if(a.prvkeypas!==undefined)throw"both prvkeypem and prvkeypas parameters not supported";else try{var b=new RSAKey;b.readPrivateKeyFromPEMString(a.prvkeypem);this.initSign(b)}catch(q){throw"fatal error to load pem private key: "+q;}}};KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};
/* (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function ECFieldElementFp(a,b){this.x=b;this.q=a}function feFpEquals(a){return a==this?true:this.q.equals(a.q)&&this.x.equals(a.x)}function feFpToBigInteger(){return this.x}function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(a){return new ECFieldElementFp(this.q,this.x.add(a.toBigInteger()).mod(this.q))}function feFpSubtract(a){return new ECFieldElementFp(this.q,this.x.subtract(a.toBigInteger()).mod(this.q))}function feFpMultiply(a){return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}function feFpDivide(a){return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger().modInverse(this.q)).mod(this.q))}ECFieldElementFp.prototype.equals=feFpEquals;ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger;ECFieldElementFp.prototype.negate=feFpNegate;ECFieldElementFp.prototype.add=feFpAdd;ECFieldElementFp.prototype.subtract=feFpSubtract;ECFieldElementFp.prototype.multiply=feFpMultiply;ECFieldElementFp.prototype.square=feFpSquare;ECFieldElementFp.prototype.divide=feFpDivide;function ECPointFp(b,c,d,a){this.curve=b;this.x=c;this.y=d;if(a==null)this.z=BigInteger.ONE;else this.z=a;this.zinv=null}function pointFpGetX(){if(this.zinv==null)this.zinv=this.z.modInverse(this.curve.q);return this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpGetY(){if(this.zinv==null)this.zinv=this.z.modInverse(this.curve.q);return this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpEquals(a){if(a==this)return true;if(this.isInfinity())return a.isInfinity();if(a.isInfinity())return this.isInfinity();var b,c;b=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q);if(!b.equals(BigInteger.ZERO))return false;c=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q);return c.equals(BigInteger.ZERO)}function pointFpIsInfinity(){return this.x==null&&this.y==null?true:this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}function pointFpAdd(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var b=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q),d=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(d))return BigInteger.ZERO.equals(b)?this.twice():this.curve.getInfinity();var h=new BigInteger("3"),i=this.x.toBigInteger(),k=this.y.toBigInteger(),n=a.x.toBigInteger(),o=a.y.toBigInteger(),g=d.square(),c=g.multiply(d),e=i.multiply(g),f=b.square().multiply(this.z),j=f.subtract(e.shiftLeft(1)).multiply(a.z).subtract(c).multiply(d).mod(this.curve.q),l=e.multiply(h).multiply(b).subtract(k.multiply(c)).subtract(f.multiply(b)).multiply(a.z).add(b.multiply(c)).mod(this.curve.q),m=c.multiply(this.z).multiply(a.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(j),this.curve.fromBigInteger(l),m)}function pointFpTwice(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var e=new BigInteger("3"),d=this.x.toBigInteger(),f=this.y.toBigInteger(),b=f.multiply(this.z),c=b.multiply(f).mod(this.curve.q),g=this.curve.a.toBigInteger(),a=d.square().multiply(e);if(!BigInteger.ZERO.equals(g))a=a.add(this.z.square().multiply(g));a=a.mod(this.curve.q);var h=a.square().subtract(d.shiftLeft(3).multiply(c)).shiftLeft(1).multiply(b).mod(this.curve.q),i=a.multiply(e).multiply(d).subtract(c.shiftLeft(1)).shiftLeft(2).multiply(c).subtract(a.square().multiply(a)).mod(this.curve.q),j=b.square().multiply(b).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(i),j)}function pointFpMultiply(f){if(this.isInfinity())return this;if(f.signum()==0)return this.curve.getInfinity();for(var d=f,e=d.multiply(new BigInteger("3")),h=this.negate(),a=this,b=e.bitLength()-2;b>0;--b){a=a.twice();var c=e.testBit(b),g=d.testBit(b);if(c!=g)a=a.add(c?this:h)}return a}function pointFpMultiplyTwo(d,e,c){var b;if(d.bitLength()>c.bitLength())b=d.bitLength()-1;else b=c.bitLength()-1;var a=this.curve.getInfinity(),f=this.add(e);while(b>=0){a=a.twice();if(d.testBit(b))if(c.testBit(b))a=a.add(f);else a=a.add(this);else if(c.testBit(b))a=a.add(e);--b}return a}ECPointFp.prototype.getX=pointFpGetX;ECPointFp.prototype.getY=pointFpGetY;ECPointFp.prototype.equals=pointFpEquals;ECPointFp.prototype.isInfinity=pointFpIsInfinity;ECPointFp.prototype.negate=pointFpNegate;ECPointFp.prototype.add=pointFpAdd;ECPointFp.prototype.twice=pointFpTwice;ECPointFp.prototype.multiply=pointFpMultiply;ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo;function ECCurveFp(c,a,b){this.q=c;this.a=this.fromBigInteger(a);this.b=this.fromBigInteger(b);this.infinity=new ECPointFp(this,null,null)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}function curveFpEquals(a){return a==this?true:this.q.equals(a.q)&&this.a.equals(a.a)&&this.b.equals(a.b)}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(a){return new ECFieldElementFp(this.q,a)}function curveFpDecodePointHex(a){switch(parseInt(a.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var b=(a.length-2)/2,c=a.substr(2,b),d=a.substr(b+2,b);return new ECPointFp(this,this.fromBigInteger(new BigInteger(c,16)),this.fromBigInteger(new BigInteger(d,16)));default:return null}}ECCurveFp.prototype.getQ=curveFpGetQ;ECCurveFp.prototype.getA=curveFpGetA;ECCurveFp.prototype.getB=curveFpGetB;ECCurveFp.prototype.equals=curveFpEquals;ECCurveFp.prototype.getInfinity=curveFpGetInfinity;ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger;ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex;
/* (c) Stefan Thomas | https://github.com/bitcoinjs/bitcoinjs-lib
 */
ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};ECPointFp.prototype.getEncoded=function(d){var b=function(c,b){var a=c.toByteArrayUnsigned();if(b<a.length)a=a.slice(a.length-b);else while(b>a.length)a.unshift(0);return a},e=this.getX().toBigInteger(),c=this.getY().toBigInteger(),a=b(e,32);if(d)if(c.isEven())a.unshift(2);else a.unshift(3);else{a.unshift(4);a=a.concat(b(c,32))}return a};ECPointFp.decodeFrom=function(c,a){var h=a[0],b=a.length-1,d=a.slice(1,1+b/2),e=a.slice(1+b/2,1+b);d.unshift(0);e.unshift(0);var f=new BigInteger(d),g=new BigInteger(e);return new ECPointFp(c,c.fromBigInteger(f),c.fromBigInteger(g))};ECPointFp.decodeFromHex=function(c,a){var h=a.substr(0,2),b=a.length-2,d=a.substr(2,b/2),e=a.substr(2+b/2,b/2),f=new BigInteger(d,16),g=new BigInteger(e,16);return new ECPointFp(c,c.fromBigInteger(f),c.fromBigInteger(g))};ECPointFp.prototype.add2D=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;if(this.x.equals(a.x))return this.y.equals(a.y)?this.twice():this.curve.getInfinity();var d=a.x.subtract(this.x),e=a.y.subtract(this.y),b=e.divide(d),c=b.square().subtract(this.x).subtract(a.x),f=b.multiply(this.x.subtract(c)).subtract(this.y);return new ECPointFp(this.curve,c,f)};ECPointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var b=this.curve.fromBigInteger(BigInteger.valueOf(2)),d=this.curve.fromBigInteger(BigInteger.valueOf(3)),a=this.x.square().multiply(d).add(this.curve.a).divide(this.y.multiply(b)),c=a.square().subtract(this.x.multiply(b)),e=a.multiply(this.x.subtract(c)).subtract(this.y);return new ECPointFp(this.curve,c,e)};ECPointFp.prototype.multiply2D=function(f){if(this.isInfinity())return this;if(f.signum()==0)return this.curve.getInfinity();for(var d=f,e=d.multiply(new BigInteger("3")),h=this.negate(),a=this,b=e.bitLength()-2;b>0;--b){a=a.twice();var c=e.testBit(b),g=d.testBit(b);if(c!=g)a=a.add2D(c?this:h)}return a};ECPointFp.prototype.isOnCurve=function(){var a=this.getX().toBigInteger(),c=this.getY().toBigInteger(),f=this.curve.getA().toBigInteger(),g=this.curve.getB().toBigInteger(),b=this.curve.getQ(),d=c.multiply(c).mod(b),e=a.multiply(a).multiply(a).add(f.multiply(a)).add(g).mod(b);return d.equals(e)};ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};ECPointFp.prototype.validate=function(){var a=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var b=this.getX().toBigInteger(),c=this.getY().toBigInteger();if(b.compareTo(BigInteger.ONE)<0||b.compareTo(a.subtract(BigInteger.ONE))>0)throw new Error("x coordinate out of bounds");if(c.compareTo(BigInteger.ONE)<0||c.compareTo(a.subtract(BigInteger.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(a).isInfinity())throw new Error("Point is not a scalar multiple of G.");return true};
/* ecdsa-modified-1.0.4.js (c) Stephan Thomas, Kenji Urushima | github.com/bitcoinjs/bitcoinjs-lib/blob/master/LICENSE
 */
if(typeof KJUR=="undefined"||!KJUR)KJUR={};if(typeof KJUR.crypto=="undefined"||!KJUR.crypto)KJUR.crypto={};KJUR.crypto.ECDSA=function(a){var b="secp256r1",h=null,f=null,g=null,c=new SecureRandom,e=null;this.type="EC";this.getBigRandom=function(a){return(new BigInteger(a.bitLength(),c)).mod(a.subtract(BigInteger.ONE)).add(BigInteger.ONE)};this.setNamedCurve=function(a){this.ecparams=KJUR.crypto.ECParameterDB.getByName(a);this.prvKeyHex=null;this.pubKeyHex=null;this.curveName=a};this.setPrivateKeyHex=function(a){this.isPrivate=true;this.prvKeyHex=a};this.setPublicKeyHex=function(a){this.isPublic=true;this.pubKeyHex=a};this.generateKeyPairHex=function(){var f=this.ecparams.n,b=this.getBigRandom(f),c=this.ecparams.G.multiply(b),g=c.getX().toBigInteger(),h=c.getY().toBigInteger(),a=this.ecparams.keylen/4,d=("0000000000"+b.toString(16)).slice(-a),i=("0000000000"+g.toString(16)).slice(-a),j=("0000000000"+h.toString(16)).slice(-a),e="04"+i+j;this.setPrivateKeyHex(d);this.setPublicKeyHex(e);return{ecprvhex:d,ecpubhex:e}};this.signWithMessageHash=function(a){return this.signHex(a,this.prvKeyHex)};this.signHex=function(d,e){var f=new BigInteger(e,16),a=this.ecparams.n,g=new BigInteger(d,16);do var c=this.getBigRandom(a),h=this.ecparams.G,i=h.multiply(c),b=i.getX().toBigInteger().mod(a);while(b.compareTo(BigInteger.ZERO)<=0);var j=c.modInverse(a).multiply(g.add(f.multiply(b))).mod(a);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(b,j)};this.sign=function(d,e){var f=e,a=this.ecparams.n,g=BigInteger.fromByteArrayUnsigned(d);do var c=this.getBigRandom(a),h=this.ecparams.G,i=h.multiply(c),b=i.getX().toBigInteger().mod(a);while(b.compareTo(BigInteger.ZERO)<=0);var j=c.modInverse(a).multiply(g.add(f.multiply(b))).mod(a);return this.serializeSig(b,j)};this.verifyWithMessageHash=function(a,b){return this.verifyHex(a,b,this.pubKeyHex)};this.verifyHex=function(f,g,e){var c,d,a=KJUR.crypto.ECDSA.parseSigHex(g);c=a.r;d=a.s;var b;b=ECPointFp.decodeFromHex(this.ecparams.curve,e);var h=new BigInteger(f,16);return this.verifyRaw(h,c,d,b)};this.verify=function(g,a,b){var d,e;if(Bitcoin.Util.isArray(a)){var f=this.parseSig(a);d=f.r;e=f.s}else if("object"===typeof a&&a.r&&a.s){d=a.r;e=a.s}else throw"Invalid value for signature";var c;if(b instanceof ECPointFp)c=b;else if(Bitcoin.Util.isArray(b))c=ECPointFp.decodeFrom(this.ecparams.curve,b);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var h=BigInteger.fromByteArrayUnsigned(g);return this.verifyRaw(h,d,e,c)};this.verifyRaw=function(h,b,c,j){var a=this.ecparams.n,i=this.ecparams.G;if(b.compareTo(BigInteger.ONE)<0||b.compareTo(a)>=0)return false;if(c.compareTo(BigInteger.ONE)<0||c.compareTo(a)>=0)return false;var d=c.modInverse(a),f=h.multiply(d).mod(a),g=b.multiply(d).mod(a),e=i.multiply(f).add(j.multiply(g)),k=e.getX().toBigInteger().mod(a);return k.equals(b)};this.serializeSig=function(d,e){var b=d.toByteArraySigned(),c=e.toByteArraySigned(),a=[];a.push(2);a.push(b.length);a=a.concat(b);a.push(2);a.push(c.length);a=a.concat(c);a.unshift(a.length);a.unshift(48);return a};this.parseSig=function(b){var a;if(b[0]!=48)throw new Error("Signature not a valid DERSequence");a=2;if(b[a]!=2)throw new Error("First element in signature must be a DERInteger");var c=b.slice(a+2,a+2+b[a+1]);a+=2+b[a+1];if(b[a]!=2)throw new Error("Second element in signature must be a DERInteger");var d=b.slice(a+2,a+2+b[a+1]);a+=2+b[a+1];var e=BigInteger.fromByteArrayUnsigned(c),f=BigInteger.fromByteArrayUnsigned(d);return{r:e,s:f}};this.parseSigCompact=function(a){if(a.length!==65)throw"Signature has the wrong length";var b=a[0]-27;if(b<0||b>7)throw"Invalid signature type";var c=this.ecparams.n,d=BigInteger.fromByteArrayUnsigned(a.slice(1,33)).mod(c),e=BigInteger.fromByteArrayUnsigned(a.slice(33,65)).mod(c);return{r:d,s:e,i:b}};if(a!==undefined)if(a.curve!==undefined)this.curveName=a.curve;if(this.curveName===undefined)this.curveName=b;this.setNamedCurve(this.curveName);if(a!==undefined){a.prv!==undefined&&this.setPrivateKeyHex(a.prv);a.pub!==undefined&&this.setPublicKeyHex(a.pub)}};KJUR.crypto.ECDSA.parseSigHex=function(b){var a=KJUR.crypto.ECDSA.parseSigHexInHexRS(b),c=new BigInteger(a.r,16),d=new BigInteger(a.s,16);return{r:c,s:d}};KJUR.crypto.ECDSA.parseSigHexInHexRS=function(a){if(a.substr(0,2)!="30")throw"signature is not a ASN.1 sequence";var b=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(b.length!=2)throw"number of signature ASN.1 sequence elements seem wrong";var c=b[0],d=b[1];if(a.substr(c,2)!="02")throw"1st item of sequene of signature is not ASN.1 integer";if(a.substr(d,2)!="02")throw"2nd item of sequene of signature is not ASN.1 integer";var e=ASN1HEX.getHexOfV_AtObj(a,c),f=ASN1HEX.getHexOfV_AtObj(a,d);return{r:e,s:f}};KJUR.crypto.ECDSA.asn1SigToConcatSig=function(d){var c=KJUR.crypto.ECDSA.parseSigHexInHexRS(d),a=c.r,b=c.s;if(a.substr(0,2)=="00"&&a.length/2*8%(16*8)==8)a=a.substr(2);if(b.substr(0,2)=="00"&&b.length/2*8%(16*8)==8)b=b.substr(2);if(a.length/2*8%(16*8)!=0)throw"unknown ECDSA sig r length error";if(b.length/2*8%(16*8)!=0)throw"unknown ECDSA sig s length error";return a+b};KJUR.crypto.ECDSA.concatSigToASN1Sig=function(a){if(a.length/2*8%(16*8)!=0)throw"unknown ECDSA concatinated r-s sig  length error";var b=a.substr(0,a.length/2),c=a.substr(a.length/2);return KJUR.crypto.ECDSA.hexRSSigToASN1Sig(b,c)};KJUR.crypto.ECDSA.hexRSSigToASN1Sig=function(c,d){var a=new BigInteger(c,16),b=new BigInteger(d,16);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(a,b)};KJUR.crypto.ECDSA.biRSSigToASN1Sig=function(d,e){var b=new KJUR.asn1.DERInteger({bigint:d}),c=new KJUR.asn1.DERInteger({bigint:e}),a=new KJUR.asn1.DERSequence({array:[b,c]});return a.getEncodedHex()};(function(){var c=CryptoJS,d=c.lib,f=d.WordArray,b=d.Hasher,g=c.algo,a=[],e=g.SM3=b.extend({_doReset:function(){this._hash=new f.init([1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214])},_doProcessBlock:function(l,k){for(var b=this._hash.words,g=b[0],d=b[1],e=b[2],f=b[3],i=b[4],c=0;c<80;c++){if(c<16)a[c]=l[k+c]|0;else{var j=a[c-3]^a[c-8]^a[c-14]^a[c-16];a[c]=j<<1|j>>>31}var h=(g<<5|g>>>27)+i+a[c];if(c<20)h+=(d&e|~d&f)+1518500249;else if(c<40)h+=(d^e^f)+1859775393;else if(c<60)h+=(d&e|d&f|e&f)-1894007588;else h+=(d^e^f)-899497514;i=f;f=e;e=d<<30|d>>>2;d=g;g=h}b[0]=b[0]+g|0;b[1]=b[1]+d|0;b[2]=b[2]+e|0;b[3]=b[3]+f|0;b[4]=b[4]+i|0},_doFinalize:function(){var c=this._data,a=c.words,d=this._nDataBytes*8,b=c.sigBytes*8;a[b>>>5]|=128<<24-b%32;a[(b+64>>>9<<4)+14]=Math.floor(d/4294967296);a[(b+64>>>9<<4)+15]=d;c.sigBytes=a.length*4;this._process();return this._hash},clone:function(){var a=b.clone.call(this);a._hash=this._hash.clone();return a}});c.SM3=b._createHelper(e);c.HmacSM3=b._createHmacHelper(e)})();function SM3Digest(){this.BYTE_LENGTH=64;this.xBuf=[];this.xBufOff=0;this.byteCount=0;this.DIGEST_LENGTH=32;this.v0=[1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214];this.v0=[1937774191,1226093241,388252375,-628488704,-1452330820,372324522,-477237683,-1325724082];this.v=new Array(8);this.v_=new Array(8);this.X0=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.X=new Array(68);this.xOff=0;this.T_00_15=2043430169;this.T_16_63=2055708042;if(arguments.length>0)this.InitDigest(arguments[0]);else this.Init()}SM3Digest.prototype={Init:function(){this.xBuf=new Array(4);this.Reset()},InitDigest:function(a){this.xBuf=new Array(a.xBuf.length);Array.Copy(a.xBuf,0,this.xBuf,0,a.xBuf.length);this.xBufOff=a.xBufOff;this.byteCount=a.byteCount;Array.Copy(a.X,0,this.X,0,a.X.length);this.xOff=a.xOff;Array.Copy(a.v,0,this.v,0,a.v.length)},GetDigestSize:function(){return this.DIGEST_LENGTH},Reset:function(){this.byteCount=0;this.xBufOff=0;Array.Clear(this.xBuf,0,this.xBuf.length);Array.Copy(this.v0,0,this.v,0,this.v0.length);this.xOff=0;Array.Copy(this.X0,0,this.X,0,this.X0.length)},GetByteLength:function(){return this.BYTE_LENGTH},ProcessBlock:function(){for(var d=this.X,i=new Array(64),b=16;b<68;b++)d[b]=this.P1(d[b-16]^d[b-9]^this.ROTATE(d[b-3],15))^this.ROTATE(d[b-13],7)^d[b-6];for(b=0;b<64;b++)i[b]=d[b]^d[b+4];var j=this.v,a=this.v_;Array.Copy(j,0,a,0,this.v0.length);var c,f,g,h,e;for(b=0;b<16;b++){e=this.ROTATE(a[0],12);c=Int32.parse(Int32.parse(e+a[4])+this.ROTATE(this.T_00_15,b));c=this.ROTATE(c,7);f=c^e;g=Int32.parse(Int32.parse(this.FF_00_15(a[0],a[1],a[2])+a[3])+f)+i[b];h=Int32.parse(Int32.parse(this.GG_00_15(a[4],a[5],a[6])+a[7])+c)+d[b];a[3]=a[2];a[2]=this.ROTATE(a[1],9);a[1]=a[0];a[0]=g;a[7]=a[6];a[6]=this.ROTATE(a[5],19);a[5]=a[4];a[4]=this.P0(h)}for(b=16;b<64;b++){e=this.ROTATE(a[0],12);c=Int32.parse(Int32.parse(e+a[4])+this.ROTATE(this.T_16_63,b));c=this.ROTATE(c,7);f=c^e;g=Int32.parse(Int32.parse(this.FF_16_63(a[0],a[1],a[2])+a[3])+f)+i[b];h=Int32.parse(Int32.parse(this.GG_16_63(a[4],a[5],a[6])+a[7])+c)+d[b];a[3]=a[2];a[2]=this.ROTATE(a[1],9);a[1]=a[0];a[0]=g;a[7]=a[6];a[6]=this.ROTATE(a[5],19);a[5]=a[4];a[4]=this.P0(h)}for(b=0;b<8;b++)j[b]^=Int32.parse(a[b]);this.xOff=0;Array.Copy(this.X0,0,this.X,0,this.X0.length)},ProcessWord:function(a,b){var c=a[b]<<24;c|=(a[++b]&255)<<16;c|=(a[++b]&255)<<8;c|=a[++b]&255;this.X[this.xOff]=c;++this.xOff==16&&this.ProcessBlock()},ProcessLength:function(a){this.xOff>14&&this.ProcessBlock();this.X[14]=this.URShiftLong(a,32);this.X[15]=a&4294967295},IntToBigEndian:function(c,b,a){b[a]=Int32.parseByte(this.URShift(c,24));b[++a]=Int32.parseByte(this.URShift(c,16));b[++a]=Int32.parseByte(this.URShift(c,8));b[++a]=Int32.parseByte(c)},DoFinal:function(b,c){this.Finish();for(var a=0;a<8;a++)this.IntToBigEndian(this.v[a],b,c+a*4);this.Reset();var d=b.length;for(a=0;a<d;a++)b[a]&=255;return this.DIGEST_LENGTH},Update:function(a){this.xBuf[this.xBufOff++]=a;if(this.xBufOff==this.xBuf.length){this.ProcessWord(this.xBuf,0);this.xBufOff=0}this.byteCount++},BlockUpdate:function(c,b,a){while(this.xBufOff!=0&&a>0){this.Update(c[b]);b++;a--}while(a>this.xBuf.length){this.ProcessWord(c,b);b+=this.xBuf.length;a-=this.xBuf.length;this.byteCount+=this.xBuf.length}while(a>0){this.Update(c[b]);b++;a--}},Finish:function(){var a=this.byteCount<<3;this.Update(128);while(this.xBufOff!=0)this.Update(0);this.ProcessLength(a);this.ProcessBlock()},ROTATE:function(b,a){return b<<a|this.URShift(b,32-a)},P0:function(a){return a^this.ROTATE(a,9)^this.ROTATE(a,17)},P1:function(a){return a^this.ROTATE(a,15)^this.ROTATE(a,23)},FF_00_15:function(a,b,c){return a^b^c},FF_16_63:function(a,b,c){return a&b|a&c|b&c},GG_00_15:function(a,b,c){return a^b^c},GG_16_63:function(a,b,c){return a&b|~a&c},URShift:function(a,b){if(a>Int32.maxValue||a<Int32.minValue)a=Int32.parse(a);return a>=0?a>>b:(a>>b)+(2<<~b)},URShiftLong:function(d,b){var c,e=new BigInteger;e.fromInt(d);if(e.signum()>=0)c=e.shiftRight(b).intValue();else{var i=new BigInteger;i.fromInt(2);var h=~b,a="";if(h<0){for(var k=64+h,j=0;j<k;j++)a+="0";var f=new BigInteger;f.fromInt(d>>b);var g=new BigInteger("10"+a,2);a=g.toRadix(10);var l=g.add(f);c=l.toRadix(10)}else{a=i.shiftLeft(~b).intValue();c=(d>>b)+a}}return c},GetZ:function(a,c){var j=CryptoJS.enc.Utf8.parse("1234567812345678"),k=j.words.length*4*8;this.Update(k>>8&255);this.Update(k&255);var b=this.GetWords(j.toString());this.BlockUpdate(b,0,b.length);var h=this.GetWords(a.curve.a.toBigInteger().toRadix(16)),i=this.GetWords(a.curve.b.toBigInteger().toRadix(16)),d=this.GetWords(a.getX().toBigInteger().toRadix(16)),e=this.GetWords(a.getY().toBigInteger().toRadix(16)),f=this.GetWords(c.substr(0,64)),g=this.GetWords(c.substr(64,64));this.BlockUpdate(h,0,h.length);this.BlockUpdate(i,0,i.length);this.BlockUpdate(d,0,d.length);this.BlockUpdate(e,0,e.length);this.BlockUpdate(f,0,f.length);this.BlockUpdate(g,0,g.length);var l=new Array(this.GetDigestSize());this.DoFinal(l,0);return l},GetWords:function(c){for(var a=[],d=c.length,b=0;b<d;b+=2)a[a.length]=parseInt(c.substr(b,2),16);return a},GetHex:function(b){for(var c=[],d=0,a=0;a<b.length*2;a+=2){c[a>>>3]|=parseInt(b[d])<<24-a%8*4;d++}var e=new CryptoJS.lib.WordArray.init(c,b.length);return e}};Array.Clear=function(a){for(elm in a)a[elm]=null};Array.Copy=function(f,c,e,b,g){for(var d=f.slice(c,c+g),a=0;a<d.length;a++){e[b]=d[a];b++}};window.Int32={minValue:-parseInt("10000000000000000000000000000000",2),maxValue:parseInt("01111111111111111111111111111111",2),parse:function(b){if(b<this.minValue){for(var g=new Number(-b),e=g.toString(2),c=e.substr(e.length-31,31),d="",a=0;a<c.length;a++){var f=c.substr(a,1);d+=f=="0"?"1":"0"}var h=parseInt(d,2);return h+1}else if(b>this.maxValue){for(var g=Number(b),e=g.toString(2),c=e.substr(e.length-31,31),d="",a=0;a<c.length;a++){var f=c.substr(a,1);d+=f=="0"?"1":"0"}var h=parseInt(d,2);return-(h+1)}else return b},parseByte:function(a){if(a<0){for(var f=new Number(-a),b=f.toString(2),d=b.substr(b.length-8,8),e="",c=0;c<d.length;c++){var g=d.substr(c,1);e+=g=="0"?"1":"0"}var h=parseInt(e,2);return h+1}else if(a>255){var f=Number(a),b=f.toString(2);return parseInt(b.substr(b.length-8,8),2)}else return a}};
/* sm3-sm2-1.0.js (c) Jonllen Peng | http://www.jonllen.com/
 */
if(typeof KJUR=="undefined"||!KJUR)KJUR={};if(typeof KJUR.crypto=="undefined"||!KJUR.crypto)KJUR.crypto={};KJUR.crypto.SM3withSM2=function(a){var b="sm2",h=null,f=null,g=null,c=new SecureRandom,e=null;this.type="SM2";this.getBigRandom=function(a){return(new BigInteger(a.bitLength(),c)).mod(a.subtract(BigInteger.ONE)).add(BigInteger.ONE)};this.setNamedCurve=function(a){this.ecparams=KJUR.crypto.ECParameterDB.getByName(a);this.prvKeyHex=null;this.pubKeyHex=null;this.curveName=a};this.setPrivateKeyHex=function(a){this.isPrivate=true;this.prvKeyHex=a};this.setPublicKeyHex=function(a){this.isPublic=true;this.pubKeyHex=a};this.generateKeyPairHex=function(){var f=this.ecparams.n,b=this.getBigRandom(f),c=this.ecparams.G.multiply(b),g=c.getX().toBigInteger(),h=c.getY().toBigInteger(),a=this.ecparams.keylen/4,d=("0000000000"+b.toString(16)).slice(-a),i=("0000000000"+g.toString(16)).slice(-a),j=("0000000000"+h.toString(16)).slice(-a),e="04"+i+j;this.setPrivateKeyHex(d);this.setPublicKeyHex(e);return{ecprvhex:d,ecpubhex:e}};this.signWithMessageHash=function(a){return this.signHex(a,this.prvKeyHex)};this.signHex=function(j,k){var l=new BigInteger(k,16),c=this.ecparams.n,m=new BigInteger(j,16),e=null,h=null,a=null,b=null,g=l;do{do{var f=this.generateKeyPairHex();e=new BigInteger(f.ecprvhex,16);var i=f.ecpubhex;h=ECPointFp.decodeFromHex(this.ecparams.curve,i);a=m.add(h.getX().toBigInteger());a=a.mod(c)}while(a.equals(BigInteger.ZERO)||a.add(e).equals(c));var d=g.add(BigInteger.ONE);d=d.modInverse(c);b=a.multiply(g);b=e.subtract(b).mod(c);b=d.multiply(b).mod(c)}while(b.equals(BigInteger.ZERO));return KJUR.crypto.ECDSA.biRSSigToASN1Sig(a,b)};this.sign=function(d,e){var f=e,a=this.ecparams.n,g=BigInteger.fromByteArrayUnsigned(d);do var c=this.getBigRandom(a),h=this.ecparams.G,i=h.multiply(c),b=i.getX().toBigInteger().mod(a);while(b.compareTo(BigInteger.ZERO)<=0);var j=c.modInverse(a).multiply(g.add(f.multiply(b))).mod(a);return this.serializeSig(b,j)};this.verifyWithMessageHash=function(a,b){return this.verifyHex(a,b,this.pubKeyHex)};this.verifyHex=function(f,g,e){var c,d,a=KJUR.crypto.ECDSA.parseSigHex(g);c=a.r;d=a.s;var b;b=ECPointFp.decodeFromHex(this.ecparams.curve,e);var h=new BigInteger(f,16);return this.verifyRaw(h,c,d,b)};this.verify=function(g,a,b){var d,e;if(Bitcoin.Util.isArray(a)){var f=this.parseSig(a);d=f.r;e=f.s}else if("object"===typeof a&&a.r&&a.s){d=a.r;e=a.s}else throw"Invalid value for signature";var c;if(b instanceof ECPointFp)c=b;else if(Bitcoin.Util.isArray(b))c=ECPointFp.decodeFrom(this.ecparams.curve,b);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var h=BigInteger.fromByteArrayUnsigned(g);return this.verifyRaw(h,d,e,c)};this.verifyRaw=function(f,c,d,h){var b=this.ecparams.n,g=this.ecparams.G,e=c.add(d).mod(b);if(e.equals(BigInteger.ZERO))return false;var a=g.multiply(d);a=a.add(h.multiply(e));var i=f.add(a.getX().toBigInteger()).mod(b);return c.equals(i)};this.serializeSig=function(d,e){var b=d.toByteArraySigned(),c=e.toByteArraySigned(),a=[];a.push(2);a.push(b.length);a=a.concat(b);a.push(2);a.push(c.length);a=a.concat(c);a.unshift(a.length);a.unshift(48);return a};this.parseSig=function(b){var a;if(b[0]!=48)throw new Error("Signature not a valid DERSequence");a=2;if(b[a]!=2)throw new Error("First element in signature must be a DERInteger");var c=b.slice(a+2,a+2+b[a+1]);a+=2+b[a+1];if(b[a]!=2)throw new Error("Second element in signature must be a DERInteger");var d=b.slice(a+2,a+2+b[a+1]);a+=2+b[a+1];var e=BigInteger.fromByteArrayUnsigned(c),f=BigInteger.fromByteArrayUnsigned(d);return{r:e,s:f}};this.parseSigCompact=function(a){if(a.length!==65)throw"Signature has the wrong length";var b=a[0]-27;if(b<0||b>7)throw"Invalid signature type";var c=this.ecparams.n,d=BigInteger.fromByteArrayUnsigned(a.slice(1,33)).mod(c),e=BigInteger.fromByteArrayUnsigned(a.slice(33,65)).mod(c);return{r:d,s:e,i:b}};if(a!==undefined)if(a.curve!==undefined)this.curveName=a.curve;if(this.curveName===undefined)this.curveName=b;this.setNamedCurve(this.curveName);if(a!==undefined){a.prv!==undefined&&this.setPrivateKeyHex(a.prv);a.pub!==undefined&&this.setPublicKeyHex(a.pub)}};
/* ecparam-1.0.0.js (c) 2013 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
if(typeof KJUR=="undefined"||!KJUR)KJUR={};if(typeof KJUR.crypto=="undefined"||!KJUR.crypto)KJUR.crypto={};KJUR.crypto.ECParameterDB=new function(){var a={},c={};function b(a){return new BigInteger(a,16)}this.getByName=function(d){var b=d;if(typeof c[b]!="undefined")b=c[d];if(typeof a[b]!="undefined")return a[b];throw"unregistered EC curve name: "+b;};this.regist=function(d,h,p,k,l,o,m,i,j,f,q,n){a[d]={};var w=b(p),r=b(k),s=b(l),v=b(o),u=b(m),g=new ECCurveFp(w,r,s),t=g.decodePointHex("04"+i+j);a[d].name=d;a[d].keylen=h;a[d].curve=g;a[d].G=t;a[d].n=v;a[d].h=u;a[d].oid=q;a[d].info=n;for(var e=0;e<f.length;e++)c[f[e]]=d}};KJUR.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");KJUR.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");KJUR.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");KJUR.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);KJUR.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);KJUR.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);KJUR.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);KJUR.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);KJUR.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);KJUR.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);KJUR.crypto.ECParameterDB.regist("sm2",256,"FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF","FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC","28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93","FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123","1","32C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7","BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0",["sm2","SM2"]);function SM2Cipher(a){this.ct=1;this.p2=null;this.sm3keybase=null;this.sm3c3=null;this.key=new Array(32);this.keyOff=0;if(typeof a!="undefined")this.cipherMode=a;else this.cipherMode=SM2CipherMode.C1C3C2}SM2Cipher.prototype={Reset:function(){this.sm3keybase=new SM3Digest;this.sm3c3=new SM3Digest;var b=this.p2.getX().toBigInteger().toRadix(16);while(b.length<64)b="0"+b;var a=this.GetWords(b),c=this.p2.getY().toBigInteger().toRadix(16);while(c.length<64)c="0"+c;var d=this.GetWords(c);this.sm3keybase.BlockUpdate(a,0,a.length);this.sm3c3.BlockUpdate(a,0,a.length);this.sm3keybase.BlockUpdate(d,0,d.length);this.ct=1;this.NextKey()},NextKey:function(){var a=new SM3Digest(this.sm3keybase);a.Update(this.ct>>24&255);a.Update(this.ct>>16&255);a.Update(this.ct>>8&255);a.Update(this.ct&255);a.DoFinal(this.key,0);this.keyOff=0;this.ct++},KDF:function(j){var d=new Array(j),a=new SM3Digest,l=new Array(32),b=1,m=j/32,k=j%32,g=this.p2.getX().toBigInteger().toRadix(16);while(g.length<64)g="0"+g;var e=this.GetWords(g),h=this.p2.getY().toBigInteger().toRadix(16);while(h.length<64)h="0"+h;for(var f=this.GetWords(h),i=0,c=0;c<m;c++){a.BlockUpdate(e,0,e.length);a.BlockUpdate(f,0,f.length);a.Update(b>>24&255);a.Update(b>>16&255);a.Update(b>>8&255);a.Update(b&255);a.DoFinal(d,i);i+=32;b++}if(k!=0){a.BlockUpdate(e,0,e.length);a.BlockUpdate(f,0,f.length);a.Update(b>>24&255);a.Update(b>>16&255);a.Update(b>>8&255);a.Update(b&255);a.DoFinal(l,0)}Array.Copy(l,0,d,i,k);for(var c=0;c<d.length;c++)d[c]=d[c]&255;return d},InitEncipher:function(f){var d=null,b=null,c=new KJUR.crypto.ECDSA({curve:"sm2"}),a=c.generateKeyPairHex();d=new BigInteger(a.ecprvhex,16);var e=a.ecpubhex;b=ECPointFp.decodeFromHex(c.ecparams.curve,e);this.p2=f.multiply(d);this.Reset();return b},EncryptBlock:function(a){this.sm3c3.BlockUpdate(a,0,a.length);for(var c=this.KDF(a.length),b=0;b<a.length;b++)a[b]^=c[b]},InitDecipher:function(a,b){this.p2=b.multiply(a);var c=this.p2.getX().toBigInteger().toRadix(16),d=this.p2.getY().toBigInteger().toRadix(16);this.Reset()},DecryptBlock:function(b){for(var c=this.KDF(b.length),a=0,d="",a=0;a<c.length;a++)d+=c[a].toString(16);for(var a=0;a<b.length;a++)b[a]^=c[a];this.sm3c3.BlockUpdate(b,0,b.length)},Dofinal:function(c){var a=this.p2.getY().toBigInteger().toRadix(16);while(a.length<64)a="0"+a;var b=this.GetWords(a);this.sm3c3.BlockUpdate(b,0,b.length);this.sm3c3.DoFinal(c,0);this.Reset()},Encrypt:function(k,d){var e=new Array(d.length);Array.Copy(d,0,e,0,d.length);var i=this.InitEncipher(k);this.EncryptBlock(e);var j=new Array(32);this.Dofinal(j);var b=i.getX().toBigInteger().toRadix(16),c=i.getY().toBigInteger().toRadix(16);while(b.length<64)b="0"+b;while(c.length<64)c="0"+c;var g=b+c,a=this.GetHex(e).toString();if(a.length%2!=0)a="0"+a;var h=this.GetHex(j).toString(),f=g+a+h;if(this.cipherMode==SM2CipherMode.C1C3C2)f=g+h+a;return f},GetWords:function(c){for(var a=[],d=c.length,b=0;b<d;b+=2)a[a.length]=parseInt(c.substr(b,2),16);return a},GetHex:function(b){for(var c=[],d=0,a=0;a<b.length*2;a+=2){c[a>>>3]|=parseInt(b[d])<<24-a%8*4;d++}var e=new CryptoJS.lib.WordArray.init(c,b.length);return e},Decrypt:function(j,i){var a=i,b=a.substr(0,64),c=a.substr(0+b.length,64),d=a.substr(b.length+c.length,a.length-b.length-c.length-64),g=a.substr(a.length-64);if(this.cipherMode==SM2CipherMode.C1C3C2){g=a.substr(b.length+c.length,64);d=a.substr(b.length+c.length+64)}var e=this.GetWords(d),m=this.CreatePoint(b,c);this.InitDecipher(j,m);this.DecryptBlock(e);var f=new Array(32);this.Dofinal(f);var k=this.GetHex(f).toString()==g;if(k){var l=this.GetHex(e),h=CryptoJS.enc.Utf8.stringify(l);return h}else return""},CreatePoint:function(d,e){var a=new KJUR.crypto.ECDSA({curve:"sm2"}),f=a.ecparams.curve,b="04"+d+e,c=ECPointFp.decodeFromHex(a.ecparams.curve,b);return c}};window.SM2CipherMode={C1C2C3:"0",C1C3C2:"1"}